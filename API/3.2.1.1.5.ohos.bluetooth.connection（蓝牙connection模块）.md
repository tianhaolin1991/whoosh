# ohos.bluetooth.connection（蓝牙connection模块）

connection模块提供了对蓝牙操作和管理的方法。

```cangjie
import kit.ConnectivityKit.*
```
## Functions

### public func getBluetoothScanMode(): ScanMode

```cangjie
public func getBluetoothScanMode(): ScanMode
```
功能： 获取蓝牙扫描模式。

**Returns:**

| type | description |
| --- | --- |
| ScanMode | 蓝牙扫描模式。 |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 通用错误码 和 蓝牙服务子系统错误码 。

| code | description |
| --- | --- |
| 201 | Permission denied. |
| 801 | Capability not supported. |
| 2900001 | Service stopped. |
| 2900003 | Bluetooth disabled. |
| 2900099 | Operation failed. |


**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.ConnectivityKit.*
import kit.PerformanceAnalysisKit.*

try {
 let scanMode: ScanMode = getBluetoothScanMode()
} catch (e: BusinessException) {
 Hilog.info(0, "Bluetooth", "errCode: ${e.code}, errMessage: ${e.message}")
}
```

### public func getLocalName(): String

```cangjie
public func getLocalName(): String
```
功能： 获取蓝牙本地设备名称。

**Returns:**

| type | description |
| --- | --- |
| String | 蓝牙本地设备名称。 |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 通用错误码 和 蓝牙服务子系统错误码 。

| code | description |
| --- | --- |
| 201 | Permission denied. |
| 801 | Capability not supported. |
| 2900001 | Service stopped. |
| 2900099 | Operation failed. |


**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.ConnectivityKit.*
import kit.PerformanceAnalysisKit.*

try {
 let localname: String = getLocalName()
} catch (e: BusinessException) {
 Hilog.info(0, "Bluetooth", "errCode: ${e.code}, errMessage: ${e.message}")
}
```

### public func getPairState(deviceId: String): BondState

```cangjie
public func getPairState(deviceId: String): BondState
```
功能： 获取蓝牙配对状态。

**Parameters:**

| type | description | name | required |
| --- | --- | --- | --- |
| String | 表示远程设备的地址，例如："XX:XX:XX:XX:XX:XX"。 | deviceId | 是 |

**Returns:**

| type | description |
| --- | --- |
| BondState | 表示设备的蓝牙配对状态。 |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 通用错误码 和 蓝牙服务子系统错误码 。

| code | description |
| --- | --- |
| 201 | Permission denied. |
| 801 | Capability not supported. |
| 2900001 | Service stopped. |
| 2900003 | Bluetooth disabled. |
| 2900099 | Operation failed. |


**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.ConnectivityKit.*
import kit.PerformanceAnalysisKit.*

try {
 getPairState("11:22:33:44:55:66")
} catch (e: BusinessException) {
 Hilog.info(0, "Bluetooth", "errCode: ${e.code}, errMessage: ${e.message}")
}
```

### public func getPairedDevices(): Array<String>

```cangjie
public func getPairedDevices(): Array<String>
```
功能： 获取蓝牙配对列表。

**Returns:**

| type | description |
| --- | --- |
| Array<String> | 已配对蓝牙设备的地址列表。基于信息安全考虑，此处获取的设备地址为随机MAC地址。配对成功后，该地址不会变更；已配对设备取消配对后重新扫描或蓝牙服务下电时，该随机地址会变更。 |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 通用错误码 和 蓝牙服务子系统错误码 。

| code | description |
| --- | --- |
| 201 | Permission denied. |
| 801 | Capability not supported. |
| 2900001 | Service stopped. |
| 2900003 | Bluetooth disabled. |
| 2900099 | Operation failed. |


**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.ConnectivityKit.*
import kit.PerformanceAnalysisKit.*

try {
 let devices: Array<String> = getPairedDevices()
} catch (e: BusinessException) {
 Hilog.info(0, "Bluetooth", "errCode: ${e.code}, errMessage: ${e.message}")
}
```

### public func getProfileConnectionState(profileId!: ?ProfileId = None): ProfileConnectionState

```cangjie
public func getProfileConnectionState(profileId!: ?ProfileId = None): ProfileConnectionState
```
功能： 获取蓝牙Profile的连接状态。如果携带ProfileId，则返回的是当前Profile的连接状态。如果未携带ProfileId，任一Profile已连接则返回STATE_CONNECTED，否则返回STATE_DISCONNECTED。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| ? ProfileId | 否 | 命名参数。 表示profile的枚举值，例如：PROFILE_A2DP_SOURCE。 | profileId | None |

**Returns:**

| type | description |
| --- | --- |
| ProfileConnectionState | profile的连接状态。 |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 通用错误码 和 蓝牙服务子系统错误码 。

| code | description |
| --- | --- |
| 201 | Permission denied. |
| 401 | Invalid parameter. Possible causes: 1. Incorrect parameter types. |
| 801 | Capability not supported. |
| 2900001 | Service stopped. |
| 2900003 | Bluetooth disabled. |
| 2900004 | Profile not supported. |
| 2900099 | Operation failed. |


**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.ConnectivityKit.*
import kit.PerformanceAnalysisKit.*

try {
 getProfileConnectionState(profileId: ProfileId.PROFILE_A2DP_SOURCE)
} catch (e: BusinessException) {
 Hilog.info(0, "Bluetooth", "errCode: ${e.code}, errMessage: ${e.message}")
}
```

### public func getRemoteDeviceBatteryInfo(deviceId: String): BatteryInfo

```cangjie
public func getRemoteDeviceBatteryInfo(deviceId: String): BatteryInfo
```
功能： 获取蓝牙远端设备的电量信息。

**Parameters:**

| type | description | name | required |
| --- | --- | --- | --- |
| String | 表示远端设备MAC地址，例如："XX:XX:XX:XX:XX:XX"。 | deviceId | 是 |

**Returns:**

| type | description |
| --- | --- |
| BatteryInfo | 蓝牙远端设备的电量信息。 |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 通用错误码 和 蓝牙服务子系统错误码 。

| code | description |
| --- | --- |
| 201 | Permission denied. |
| 401 | Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed. |
| 2900001 | Service stopped. |
| 2900003 | Bluetooth disabled. |


**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.ConnectivityKit.*
import kit.PerformanceAnalysisKit.*

try {
 getRemoteDeviceBatteryInfo("11:22:33:44:55:66")
} catch (e: BusinessException) {
 Hilog.info(0, "Bluetooth", "errCode: ${e.code}, errMessage: ${e.message}")
}
```

### public func getRemoteDeviceClass(deviceId: String): DeviceClass

```cangjie
public func getRemoteDeviceClass(deviceId: String): DeviceClass
```
功能： 获取对端蓝牙设备的类别。

**Parameters:**

| type | description | name | required |
| --- | --- | --- | --- |
| String | 表示远程设备的地址，例如："XX:XX:XX:XX:XX:XX"。 | deviceId | 是 |

**Returns:**

| type | description |
| --- | --- |
| DeviceClass | 远程设备的类别。 |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 通用错误码 和 蓝牙服务子系统错误码 。

| code | description |
| --- | --- |
| 201 | Permission denied. |
| 401 | Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed. |
| 801 | Capability not supported. |
| 2900001 | Service stopped. |
| 2900003 | Bluetooth disabled. |
| 2900099 | Operation failed. |


**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.ConnectivityKit.*
import kit.PerformanceAnalysisKit.*

try {
 getRemoteDeviceClass("11:22:33:44:55:66")
} catch (e: BusinessException) {
 Hilog.info(0, "Bluetooth", "errCode: ${e.code}, errMessage: ${e.message}")
}
```

### public func getRemoteDeviceName(deviceId: String): String

```cangjie
public func getRemoteDeviceName(deviceId: String): String
```
功能： 获取对端蓝牙设备的名称。

**Parameters:**

| type | description | name | required |
| --- | --- | --- | --- |
| String | 表示远程设备的地址，例如："XX:XX:XX:XX:XX:XX"。 | deviceId | 是 |

**Returns:**

| type | description |
| --- | --- |
| String | 以字符串格式返回设备名称。 |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 通用错误码 和 蓝牙服务子系统错误码 。

| code | description |
| --- | --- |
| 201 | Permission denied. |
| 401 | Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed. |
| 801 | Capability not supported. |
| 2900001 | Service stopped. |
| 2900003 | Bluetooth disabled. |
| 2900099 | Operation failed. |


**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.ConnectivityKit.*
import kit.PerformanceAnalysisKit.*

try {
 let RemoteDeviceName: String = getRemoteDeviceName("11:22:33:44:55:66")
} catch (e: BusinessException) {
 Hilog.info(0, "Bluetooth", "errCode: ${e.code}, errMessage: ${e.message}")
}
```

### public func getRemoteProfileUuids(deviceId: String): Array<ProfileUuids>

```cangjie
public func getRemoteProfileUuids(deviceId: String): Array<ProfileUuids>
```
功能： 获取对端蓝牙设备支持的Profile UUID。

**Parameters:**

| type | description | name | required |
| --- | --- | --- | --- |
| String | 表示配对的远端设备地址，例如："XX:XX:XX:XX:XX:XX"。 | deviceId | 是 |

**Returns:**

| type | description |
| --- | --- |
| Array< ProfileUuids > | 对端蓝牙设备支持的Profile UUID。 |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 通用错误码 和 蓝牙服务子系统错误码 。

| code | description |
| --- | --- |
| 201 | Permission denied. |
| 401 | Invalid parameter. |
| 801 | Capability not supported. |
| 2900001 | Service stopped. |
| 2900003 | Bluetooth disabled. |
| 2900099 | Operation failed. |


**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.ConnectivityKit.*
import kit.PerformanceAnalysisKit.*

try {
 getRemoteProfileUuids("11:22:33:44:55:66")
} catch (e: BusinessException) {
 Hilog.info(0, "Bluetooth", "errCode: ${e.code}, errMessage: ${e.message}")
}
```

### public func isBluetoothDiscovering(): Bool

```cangjie
public func isBluetoothDiscovering(): Bool
```
功能： 查询设备的蓝牙发现状态。

**Returns:**

| type | description |
| --- | --- |
| Bool | 设备已开启蓝牙发现为true，否则为false。 |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 通用错误码 和 蓝牙服务子系统错误码 。

| code | description |
| --- | --- |
| 201 | Permission denied. |
| 801 | Capability not supported. |
| 2900001 | Service stopped. |
| 2900003 | Bluetooth disabled. |
| 2900099 | Operation failed. |


**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.ConnectivityKit.*
import kit.PerformanceAnalysisKit.*

try {
 let res: Bool = isBluetoothDiscovering()
} catch (e: BusinessException) {
 Hilog.info(0, "Bluetooth", "errCode: ${e.code}, errMessage: ${e.message}")
}
```

### public func off(`type`: BluetoothConnectionCallbackType, callback!: ?CallbackObject = None): Unit

```cangjie
public func off(`type`: BluetoothConnectionCallbackType, callback!: ?CallbackObject = None): Unit
```
功能： 取消订阅蓝牙设备发现上报事件。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| BluetoothConnectionCallbackType | 是 | 填写 BATTERY_CHANGE ，表示蓝牙远端设备的电池信息变更事件。填写 BLUETOOTH_DEVICE_FIND ，表示蓝牙设备发现事件。 | `type` | - |
| ? CallbackObject | 否 | 命名参数。 表示取消订阅蓝牙设备发现事件上报。不填该参数则取消订阅该type对应的所有回调。 | callback | None |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 通用错误码 和 蓝牙服务子系统错误码 。

| code | description |
| --- | --- |
| 201 | Permission denied. |
| 801 | Capability not supported. |
| 2900099 | Operation failed. |


**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.ConnectivityKit.*
import kit.PerformanceAnalysisKit.*

// 此处代码可添加在依赖项定义中
class FindDevicesCallback <: Callback1Argument<Array<String>> {
 public func invoke(devices: Array<String>): Unit {
 for (device in devices) {
 Hilog.info(0, "Bluetooth", "find device ${device}")
 }
 }
}

let onReceiveEvent = FindDevicesCallback()
try {
 on(BLUETOOTH_DEVICE_FIND, onReceiveEvent)
 off(BLUETOOTH_DEVICE_FIND, callback: onReceiveEvent)
} catch (e: BusinessException) {
 Hilog.info(0, "Bluetooth", "errCode: ${e.code}, errMessage: ${e.message}")
}
```

### public func on(`type`: BluetoothConnectionCallbackType, callback: Callback1Argument<BatteryInfo>): Unit

```cangjie
public func on(`type`: BluetoothConnectionCallbackType, callback: Callback1Argument<BatteryInfo>): Unit
```
功能： 订阅蓝牙远程设备的电量信息变更事件。使用Callback异步回调。

**Parameters:**

| type | description | name | required |
| --- | --- | --- | --- |
| BluetoothConnectionCallbackType | 填写 BATTERY_CHANGE ，表示蓝牙远端设备的电池信息变更事件。 | `type` | 是 |
| Callback1Argument < BatteryInfo > | 表示回调函数的入参，返回电量信息。 | callback | 是 |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 通用错误码 和 蓝牙服务子系统错误码 。

| code | description |
| --- | --- |
| 201 | Permission denied. |
| 2900099 | Operation failed. |


**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.ConnectivityKit.*
import kit.PerformanceAnalysisKit.*

// 此处代码可添加在依赖项定义中
class BatteryCallback <: Callback1Argument<BatteryInfo> {
 public func invoke(data: BatteryInfo): Unit {
 Hilog.info(0, "Bluetooth", "remote device battery has change")
 }
}

let onPairStatusChanged = BatteryCallback()
try {
 on(BATTERY_CHANGE, onPairStatusChanged)
} catch (e: BusinessException) {
 Hilog.info(0, "Bluetooth", "errCode: ${e.code}, errMessage: ${e.message}")
}
```

### public func on(`type`: BluetoothConnectionCallbackType, callback: Callback1Argument<Array<String>>): Unit

```cangjie
public func on(`type`: BluetoothConnectionCallbackType, callback: Callback1Argument<Array<String>>): Unit
```
功能： 订阅蓝牙设备发现上报事件。使用Callback异步回调。

**Parameters:**

| type | description | name | required |
| --- | --- | --- | --- |
| BluetoothConnectionCallbackType | 填写 BLUETOOTH_DEVICE_FIND ，表示蓝牙设备发现事件。 | `type` | 是 |
| Callback1Argument <Array<String>> | 表示回调函数的入参，发现的设备集合。回调函数由用户创建通过该接口注册。基于信息安全考虑，此处获取的设备地址为随机MAC地址。配对成功后，该地址不会变更；已配对设备取消配对后重新扫描或蓝牙服务下电时，该随机地址会变更。 | callback | 是 |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 通用错误码 和 蓝牙服务子系统错误码 。

| code | description |
| --- | --- |
| 201 | Permission denied. |
| 401 | Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed. |
| 801 | Capability not supported. |
| 2900099 | Operation failed. |


**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.ConnectivityKit.*
import kit.PerformanceAnalysisKit.*

// 此处代码可添加在依赖项定义中
class FindDevicesCallback <: Callback1Argument<Array<String>> {
 public func invoke(devices: Array<String>): Unit {
 for (device in devices) {
 Hilog.info(0, "Bluetooth", "find device ${device}")
 }
 }
}

let onReceiveEvent = FindDevicesCallback()
try {
 on(BLUETOOTH_DEVICE_FIND, onReceiveEvent)
} catch (e: BusinessException) {
 Hilog.info(0, "Bluetooth", "errCode: ${e.code}, errMessage: ${e.message}")
}
```

### public func on(`type`: BluetoothConnectionCallbackType, callback: Callback1Argument<BondStateParam>): Unit

```cangjie
public func on(`type`: BluetoothConnectionCallbackType, callback: Callback1Argument<BondStateParam>): Unit
```
功能： 订阅蓝牙配对状态改变事件。使用Callback异步回调。

**Parameters:**

| type | description | name | required |
| --- | --- | --- | --- |
| BluetoothConnectionCallbackType | 填写 BOND_STATE_CHANGE ，表示蓝牙配对状态改变事件。 | `type` | 是 |
| Callback1Argument < BondStateParam > | 表示回调函数的入参，配对的状态。回调函数由用户创建通过该接口注册。 | callback | 是 |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 通用错误码 和 蓝牙服务子系统错误码 。

| code | description |
| --- | --- |
| 201 | Permission denied. |
| 401 | Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed. |
| 801 | Capability not supported. |
| 2900099 | Operation failed. |


**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.ConnectivityKit.*
import kit.PerformanceAnalysisKit.*

// 此处代码可添加在依赖项定义中
class BondStateChangeCallback <: Callback1Argument<BondStateParam> {
 public func invoke(state: BondStateParam): Unit {
 Hilog.info(0, "Bluetooth", "bond state has change")
 }
}

let onStateChange = BondStateChangeCallback()
try {
 on(BOND_STATE_CHANGE, onStateChange)
} catch (e: BusinessException) {
 Hilog.info(0, "Bluetooth", "errCode: ${e.code}, errMessage: ${e.message}")
}
```

### public func on(`type`: BluetoothConnectionCallbackType, callback: Callback1Argument<PinRequiredParam>): Unit

```cangjie
public func on(`type`: BluetoothConnectionCallbackType, callback: Callback1Argument<PinRequiredParam>): Unit
```
功能： 订阅远端蓝牙设备的配对请求事件。使用Callback异步回调。

**Parameters:**

| type | description | name | required |
| --- | --- | --- | --- |
| BluetoothConnectionCallbackType | 填写 PIN_REQUIRED ，表示配对请求事件。 | `type` | 是 |
| Callback1Argument < PinRequiredParam > | 表示回调函数的入参，配对请求。回调函数由用户创建通过该接口注册。 | callback | 是 |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 通用错误码 和 蓝牙服务子系统错误码 。

| code | description |
| --- | --- |
| 201 | Permission denied. |
| 401 | Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed. |
| 801 | Capability not supported. |
| 2900099 | Operation failed. |


**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.ConnectivityKit.*
import kit.PerformanceAnalysisKit.*

// 此处代码可添加在依赖项定义中
class PinRequiredCallback <: Callback1Argument<PinRequiredParam> {
 public func invoke(data: PinRequiredParam): Unit {
 setDevicePairingConfirmation(data.deviceId, true)
 }
}

let onPairConfirmed = PinRequiredCallback()
try {
 on(PIN_REQUIRED, onPairConfirmed)
} catch (e: BusinessException) {
 Hilog.info(0, "Bluetooth", "errCode: ${e.code}, errMessage: ${e.message}")
}
```

### public func pairDevice(deviceId: String): Unit

```cangjie
public func pairDevice(deviceId: String): Unit
```
功能： 发起蓝牙配对。

**Parameters:**

| type | description | name | required |
| --- | --- | --- | --- |
| String | 表示配对的远端设备地址，例如："XX:XX:XX:XX:XX:XX"。 | deviceId | 是 |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 通用错误码 和 蓝牙服务子系统错误码 。

| code | description |
| --- | --- |
| 201 | Permission denied. |
| 401 | Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed. |
| 801 | Capability not supported. |
| 2900001 | Service stopped. |
| 2900003 | Bluetooth disabled. |
| 2900099 | Operation failed. |


**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.ConnectivityKit.*
import kit.PerformanceAnalysisKit.*

try {
 pairDevice("11:22:33:44:55:66")
} catch (e: BusinessException) {
 Hilog.info(0, "Bluetooth", "errCode: ${e.code}, errMessage: ${e.message}")
}
```

### public func setBluetoothScanMode(mode: ScanMode, duration: Int32): Unit

```cangjie
public func setBluetoothScanMode(mode: ScanMode, duration: Int32): Unit
```
功能： 设置蓝牙扫描模式，可以被远端设备发现。

**Parameters:**

| type | description | name | required |
| --- | --- | --- | --- |
| ScanMode | 蓝牙扫描模式。当扫描模式为SCAN_MODE_GENERAL_DISCOVERABLE时，如果超出duration持续时间（不为0），扫描模式会重新设置为SCAN_MODE_CONNECTABLE。 | mode | 是 |
| Int32 | 设备可被发现的持续时间，单位为毫秒；设置为0则持续可发现。 | duration | 是 |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 通用错误码 和 蓝牙服务子系统错误码 。

| code | description |
| --- | --- |
| 201 | Permission denied. |
| 401 | Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed. |
| 801 | Capability not supported. |
| 2900001 | Service stopped. |
| 2900003 | Bluetooth disabled. |
| 2900099 | Operation failed. |


**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.ConnectivityKit.*
import kit.PerformanceAnalysisKit.*

try {
 setBluetoothScanMode(SCAN_MODE_CONNECTABLE_GENERAL_DISCOVERABLE, 100)
} catch (e: BusinessException) {
 Hilog.info(0, "Bluetooth", "errCode: ${e.code}, errMessage: ${e.message}")
}
```

### public func setDevicePairingConfirmation(deviceId: String, accept: Bool): Unit

```cangjie
public func setDevicePairingConfirmation(deviceId: String, accept: Bool): Unit
```
功能： 设置设备配对请求确认。

**Parameters:**

| type | description | name | required |
| --- | --- | --- | --- |
| String | 表示远端设备地址，例如："XX:XX:XX:XX:XX:XX"。 | deviceId | 是 |
| Bool | 接受配对请求设置为true，否则设置为false。 | accept | 是 |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 通用错误码 和 蓝牙服务子系统错误码 。

| code | description |
| --- | --- |
| 201 | Permission denied. |
| 401 | Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed. |
| 801 | Capability not supported. |
| 2900001 | Service stopped. |
| 2900003 | Bluetooth disabled. |
| 2900099 | Operation failed. |


**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.ConnectivityKit.*
import kit.PerformanceAnalysisKit.*

// 此处代码可添加在依赖项定义中
class PinRequiredCallback <: Callback1Argument<PinRequiredParam> {
 public func invoke(data: PinRequiredParam): Unit {
 setDevicePairingConfirmation(data.deviceId, true)
 }
}

let onPairConfirmed = PinRequiredCallback()
try {
 on(PIN_REQUIRED, onPairConfirmed)
} catch (e: BusinessException) {
 Hilog.info(0, "Bluetooth", "errCode: ${e.code}, errMessage: ${e.message}")
}
```

### public func setDevicePinCode(deviceId: String, code: String): Unit

```cangjie
public func setDevicePinCode(deviceId: String, code: String): Unit
```
功能： 当蓝牙配对类型PinType为PIN_TYPE_ENTER_PIN_CODE或PIN_TYPE_PIN_16_DIGITS时调用此接口，请求用户输入PIN码。

**Parameters:**

| type | description | name | required |
| --- | --- | --- | --- |
| String | 表示远端设备MAC地址，例如："XX:XX:XX:XX:XX:XX"。 | deviceId | 是 |
| String | 用户输入的PIN码。 | code | 是 |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 通用错误码 和 蓝牙服务子系统错误码 。

| code | description |
| --- | --- |
| 201 | Permission denied. |
| 401 | Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed. |
| 801 | Capability not supported. |
| 2900001 | Service stopped. |
| 2900003 | Bluetooth disabled. |
| 2900099 | Operation failed. |


**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.ConnectivityKit.*
import kit.PerformanceAnalysisKit.*

try {
 setDevicePinCode("11:22:33:44:55:66", "12345")
} catch (e: BusinessException) {
 Hilog.info(0, "Bluetooth", "errCode: ${e.code}, errMessage: ${e.message}")
}
```

### public func setLocalName(name: String): Unit

```cangjie
public func setLocalName(name: String): Unit
```
功能： 设置蓝牙本地设备名称。

**Parameters:**

| type | description | name | required |
| --- | --- | --- | --- |
| String | 要设置的蓝牙名称，最大长度为248字节数。 | name | 是 |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 通用错误码 和 蓝牙服务子系统错误码 。

| code | description |
| --- | --- |
| 201 | Permission denied. |
| 401 | Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed. |
| 801 | Capability not supported. |
| 2900001 | Service stopped. |
| 2900003 | Bluetooth disabled. |
| 2900099 | Operation failed. |


**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.ConnectivityKit.*
import kit.PerformanceAnalysisKit.*

try {
 setLocalName("device_name")
} catch (e: BusinessException) {
 Hilog.info(0, "Bluetooth", "errCode: ${e.code}, errMessage: ${e.message}")
}
```

### public func setRemoteDeviceName(deviceId: String, name: String): Unit

```cangjie
public func setRemoteDeviceName(deviceId: String, name: String): Unit
```
功能： 设置蓝牙远端设备名称。

**Parameters:**

| type | description | name | required |
| --- | --- | --- | --- |
| String | 表示远端设备MAC地址，例如："XX:XX:XX:XX:XX:XX"。 | deviceId | 是 |
| String | 修改远端设备名称，最大长度为64字节。 | name | 是 |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 通用错误码 和 蓝牙服务子系统错误码 。

| code | description |
| --- | --- |
| 201 | Permission denied. |
| 401 | Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed. |
| 2900001 | Service stopped. |
| 2900003 | Bluetooth disabled. |


**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.ConnectivityKit.*
import kit.PerformanceAnalysisKit.*

try {
 setRemoteDeviceName("11:22:33:44:55:66", "RemoteDeviceName")
} catch (e: BusinessException) {
 Hilog.info(0, "Bluetooth", "errCode: ${e.code}, errMessage: ${e.message}")
}
```

### public func startBluetoothDiscovery(): Unit

```cangjie
public func startBluetoothDiscovery(): Unit
```
功能： 开启蓝牙扫描，可以发现远端设备。

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 通用错误码 和 蓝牙服务子系统错误码 。

| code | description |
| --- | --- |
| 201 | Permission denied. |
| 801 | Capability not supported. |
| 2900001 | Service stopped. |
| 2900003 | Bluetooth disabled. |
| 2900099 | Operation failed. |


**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.ConnectivityKit.*
import kit.PerformanceAnalysisKit.*

try {
 startBluetoothDiscovery()
} catch (e: BusinessException) {
 Hilog.info(0, "Bluetooth", "errCode: ${e.code}, errMessage: ${e.message}")
}
```

### public func stopBluetoothDiscovery(): Unit

```cangjie
public func stopBluetoothDiscovery(): Unit
```
功能： 关闭蓝牙扫描。

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 通用错误码 和 蓝牙服务子系统错误码 。

| code | description |
| --- | --- |
| 201 | Permission denied. |
| 801 | Capability not supported. |
| 2900001 | Service stopped. |
| 2900003 | Bluetooth disabled. |
| 2900099 | Operation failed. |


**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.ConnectivityKit.*
import kit.PerformanceAnalysisKit.*

try {
 stopBluetoothDiscovery()
} catch (e: BusinessException) {
 Hilog.info(0, "Bluetooth", "errCode: ${e.code}, errMessage: ${e.message}")
}
```


## Classes

### BatteryInfo

class BatteryInfo
```cangjie
public class BatteryInfo {}
```
功能： 描述电量信息的内容。

#### let batteryLevel

```cangjie
public let batteryLevel: Int32
```
功能： 表示远端设备的电量值，如果值为-1，表示没有电量信息。
Type: Int32; Readable: true; Writable: false

#### let boxBatteryLevel

```cangjie
public let boxBatteryLevel: Int32
```
功能： 表示耳机仓的电量值，如果值为-1，表示没有电量信息。
Type: Int32; Readable: true; Writable: false

#### let boxChargeState

```cangjie
public let boxChargeState: DeviceChargeState
```
功能： 表示耳机仓的充电状态。
Type: DeviceChargeState; Readable: true; Writable: false

#### let leftEarBatteryLevel

```cangjie
public let leftEarBatteryLevel: Int32
```
功能： 表示左侧耳机的电量值，如果值为-1，表示没有电量信息。
Type: Int32; Readable: true; Writable: false

#### let leftEarChargeState

```cangjie
public let leftEarChargeState: DeviceChargeState
```
功能： 表示左侧耳机的充电状态。
Type: DeviceChargeState; Readable: true; Writable: false

#### let rightEarBatteryLevel

```cangjie
public let rightEarBatteryLevel: Int32
```
功能： 表示右侧耳机的电量值，如果值为-1，表示没有电量信息。
Type: Int32; Readable: true; Writable: false

#### let rightEarChargeState

```cangjie
public let rightEarChargeState: DeviceChargeState
```
功能： 表示右侧耳机的充电状态。
Type: DeviceChargeState; Readable: true; Writable: false


### BondStateParam

class BondStateParam
```cangjie
public class BondStateParam {}
```
功能： 描述配对状态参数。

#### let cause

```cangjie
public let cause: UnbondCause
```
功能： 表示配对失败的原因。
Type: UnbondCause; Readable: true; Writable: false

#### let deviceId

```cangjie
public let deviceId: String
```
功能： 表示要配对的设备ID。
Type: String; Readable: true; Writable: false

#### let state

```cangjie
public let state: BondState
```
功能： 表示配对设备的状态。
Type: BondState; Readable: true; Writable: false


### DeviceClass

class DeviceClass
```cangjie
public class DeviceClass {}
```
功能： 描述蓝牙设备的类别。

#### let classOfDevice

```cangjie
public let classOfDevice: Int32
```
功能： 表示设备类别。
Type: Int32; Readable: true; Writable: false

#### let majorClass

```cangjie
public let majorClass: MajorClass
```
功能： 表示蓝牙设备主要类别。
Type: MajorClass; Readable: true; Writable: false

#### let majorMinorClass

```cangjie
public let majorMinorClass: MajorMinorClass
```
功能： 表示主要次要蓝牙设备类别。
Type: MajorMinorClass; Readable: true; Writable: false


### PinRequiredParam

class PinRequiredParam
```cangjie
public class PinRequiredParam {}
```
功能： 描述配对请求参数。

#### let deviceId

```cangjie
public let deviceId: String
```
功能： 表示要配对的设备ID。
Type: String; Readable: true; Writable: false

#### let pinCode

```cangjie
public let pinCode: String
```
功能： 表示要配对的密钥。
Type: String; Readable: true; Writable: false



## Enums

### BluetoothConnectionCallbackType

enum BluetoothConnectionCallbackType
```cangjie
public enum BluetoothConnectionCallbackType <: Equatable<BluetoothConnectionCallbackType> & Hashable & ToString { | BATTERY_CHANGE | BLUETOOTH_DEVICE_FIND | BOND_STATE_CHANGE | PIN_REQUIRED | ... }
```
功能： on/off事件的类型。

#### BATTERY_CHANGE

```cangjie
BATTERY_CHANGE
```
功能： 表示蓝牙远端设备的电池信息变更事件。

#### BLUETOOTH_DEVICE_FIND

```cangjie
BLUETOOTH_DEVICE_FIND
```
功能： 表示蓝牙设备发现事件。

#### BOND_STATE_CHANGE

```cangjie
BOND_STATE_CHANGE
```
功能： 表示蓝牙配对状态改变事件。

#### PIN_REQUIRED

```cangjie
PIN_REQUIRED
```
功能： 表示配对请求事件。


### BluetoothTransport

enum BluetoothTransport
```cangjie
public enum BluetoothTransport <: Equatable<BluetoothTransport> & ToString { | TRANSPORT_BR_EDR | TRANSPORT_LE | ... }
```
功能： 表示设备类型。例如传统蓝牙设备或低功耗蓝牙设备，支持双模默认使用TRANSPORT_BR_EDR。

#### TRANSPORT_BR_EDR

```cangjie
TRANSPORT_BR_EDR
```
功能： 表示传统蓝牙(BR/EDR)设备。

#### TRANSPORT_LE

```cangjie
TRANSPORT_LE
```
功能： 表示低功耗蓝牙(BLE)设备。


### BondState

enum BondState
```cangjie
public enum BondState <: Equatable<BondState> & ToString { | BOND_STATE_INVALID | BOND_STATE_BONDING | BOND_STATE_BONDED | ... }
```
功能： 配对状态。

#### BOND_STATE_BONDED

```cangjie
BOND_STATE_BONDED
```
功能： 已配对。

#### BOND_STATE_BONDING

```cangjie
BOND_STATE_BONDING
```
功能： 正在配对。

#### BOND_STATE_INVALID

```cangjie
BOND_STATE_INVALID
```
功能： 无效的配对。


### DeviceChargeState

enum DeviceChargeState
```cangjie
public enum DeviceChargeState <: Equatable<DeviceChargeState> & ToString { | DEVICE_NORMAL_CHARGE_NOT_CHARGED | DEVICE_NORMAL_CHARGE_IN_CHARGING | DEVICE_SUPER_CHARGE_NOT_CHARGED | DEVICE_SUPER_CHARGE_IN_CHARGING | ... }
```
功能： 表示充电状态。

#### DEVICE_NORMAL_CHARGE_IN_CHARGING

```cangjie
DEVICE_NORMAL_CHARGE_IN_CHARGING
```
功能： 正在充电，不支持超级充电。

#### DEVICE_NORMAL_CHARGE_NOT_CHARGED

```cangjie
DEVICE_NORMAL_CHARGE_NOT_CHARGED
```
功能： 未充电，不支持超级充电。

#### DEVICE_SUPER_CHARGE_IN_CHARGING

```cangjie
DEVICE_SUPER_CHARGE_IN_CHARGING
```
功能： 正在充电，支持超级充电。

#### DEVICE_SUPER_CHARGE_NOT_CHARGED

```cangjie
DEVICE_SUPER_CHARGE_NOT_CHARGED
```
功能： 未充电，支持超级充电。


### ScanMode

enum ScanMode
```cangjie
public enum ScanMode <: Equatable<ScanMode> & ToString { | SCAN_MODE_NONE | SCAN_MODE_CONNECTABLE | SCAN_MODE_GENERAL_DISCOVERABLE | SCAN_MODE_LIMITED_DISCOVERABLE | SCAN_MODE_CONNECTABLE_GENERAL_DISCOVERABLE | SCAN_MODE_CONNECTABLE_LIMITED_DISCOVERABLE | ... }
```
功能： 扫描模式。

#### SCAN_MODE_CONNECTABLE

```cangjie
SCAN_MODE_CONNECTABLE
```
功能： 可连接扫描模式。

#### SCAN_MODE_CONNECTABLE_GENERAL_DISCOVERABLE

```cangjie
SCAN_MODE_CONNECTABLE_GENERAL_DISCOVERABLE
```
功能： 可连接general发现模式。

#### SCAN_MODE_CONNECTABLE_LIMITED_DISCOVERABLE

```cangjie
SCAN_MODE_CONNECTABLE_LIMITED_DISCOVERABLE
```
功能： 可连接limited发现模式。

#### SCAN_MODE_GENERAL_DISCOVERABLE

```cangjie
SCAN_MODE_GENERAL_DISCOVERABLE
```
功能： general发现模式。

#### SCAN_MODE_LIMITED_DISCOVERABLE

```cangjie
SCAN_MODE_LIMITED_DISCOVERABLE
```
功能： limited发现模式。

#### SCAN_MODE_NONE

```cangjie
SCAN_MODE_NONE
```
功能： 没有扫描模式。


### UnbondCause

enum UnbondCause
```cangjie
public enum UnbondCause <: Equatable<UnbondCause> & ToString { | USER_REMOVED | REMOTE_DEVICE_DOWN | AUTH_FAILURE | AUTH_REJECTED | INTERNAL_ERROR | ... }
```
功能： 配对失败原因。

#### AUTH_FAILURE

```cangjie
AUTH_FAILURE
```
功能： PIN码错误。

#### AUTH_REJECTED

```cangjie
AUTH_REJECTED
```
功能： 远端设备鉴权拒绝。

#### INTERNAL_ERROR

```cangjie
INTERNAL_ERROR
```
功能： 内部错误。

#### REMOTE_DEVICE_DOWN

```cangjie
REMOTE_DEVICE_DOWN
```
功能： 远端设备关闭。

#### USER_REMOVED

```cangjie
USER_REMOVED
```
功能： 用户主动移除设备。



