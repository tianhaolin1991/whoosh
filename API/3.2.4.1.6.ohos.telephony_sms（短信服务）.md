# ohos.telephony_sms（短信服务）

短信服务提供了管理短信的一些基础能力，包括创建、发送短信，获取发送短信的默认SIM卡槽ID，以及检查当前设备是否具备短信发送和接收能力等。

```cangjie
import kit.TelephonyKit.*
```
## Functions

### public func createMessage(pdu: Array<Int32>, specification: String): ShortMessage

```cangjie
public func createMessage(pdu: Array<Int32>, specification: String): ShortMessage
```
功能： 根据协议数据单元（PDU）和指定的短信协议创建短信实例。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| Array<Int32> | 是 | 协议数据单元，从收到的信息中获取。 | pdu | - |
| String | 是 | 短信协议类型。 - 3gpp：表示GSM/UMTS/LTE SMS。 - 3gpp2：表示CDMA SMS。 | specification | - |

**Returns:**

| type | description |
| --- | --- |
| ShortMessage | 短信实例。 |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 电话子系统错误码 和 通用错误码 。

| code | description |
| --- | --- |
| 401 | Parameter error. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. |
| 8300001 | Invalid parameter value. |
| 8300002 | Operation failed. Cannot connect to service. |
| 8300003 | System internal error. |
| 8300999 | Unknown error code. |


**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.TelephonyKit.*

let pdu: Array<Int32> = [0x01, 0x00, 0x05, 0x81, 0x01, 0x80, 0xF6, 0x00, 0x00, 0x05, 0xE8, 0x32,
 0x9B, 0xFD, 0x06]
let message = createMessage(pdu, "3gpp")
```

### public func getDefaultSmsSimId(): Int32

```cangjie
public func getDefaultSmsSimId(): Int32
```
功能： 获取发送短信的默认SIM卡ID。

**Returns:**

| type | description |
| --- | --- |
| Int32 | 发送短信的默认SIM卡ID： 与SIM卡绑定，从1开始递增。 无卡时返回值为-1。 |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 电话子系统错误码 。

| code | description |
| --- | --- |
| 8300001 | Invalid parameter value. |
| 8300002 | Operation failed. Cannot connect to service. |
| 8300003 | System internal error. |
| 8300004 | Do not have sim card. |
| 8300999 | Unknown error code. |
| 8301001 | SIM card is not activated. |


**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.TelephonyKit.*

getDefaultSmsSimId()
```

### public func getDefaultSmsSlotId(): Int32

```cangjie
public func getDefaultSmsSlotId(): Int32
```
功能： 获取发送短信的默认SIM卡槽ID。

**Returns:**

| type | description |
| --- | --- |
| Int32 | 发送短信的默认SIM卡： - 0：卡槽1。 - 1：卡槽2。 |

**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.TelephonyKit.*

getDefaultSmsSlotId()
```

### public func hasSmsCapability(): Bool

```cangjie
public func hasSmsCapability(): Bool
```
功能： 检查当前设备是否具备短信发送和接收能力。

**Returns:**

| type | description |
| --- | --- |
| Bool | - true：设备具备短信发送和接收能力。 - false：设备不具备短信发送和接收能力。 |

**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.TelephonyKit.*

hasSmsCapability()
```


## Classes

### SendMessageOptions

class SendMessageOptions
```cangjie
public class SendMessageOptions { public SendMessageOptions( public let slotId: Int32, public let destinationHost: String, public let content: ContentType, public let serviceCenter!: String = "", public let destinationPort!: UInt16 = 0, public let sendCallback!: ?ISendShortMessageCallback = None, public let deliveryCallback!: ?IDeliveryShortMessageCallback = None ) }
```
功能： 发送短信的参数和回调。根据SendMessageOptions中的参数content的值判断短信类型。

#### let content

```cangjie
public let content: ContentType
```
功能： 如果内容是字符串，则这是一条文本短信。如果内容是字节数组，则这是一条数据短信。
Type: ContentType; Readable: true; Writable: false

#### let deliveryCallback

```cangjie
public let deliveryCallback: ?IDeliveryShortMessageCallback = None
```
功能： 短信送达结果回调，返回短信递送报告。
Type: ? IDeliveryShortMessageCallback; Readable: true; Writable: false

#### let destinationHost

```cangjie
public let destinationHost: String
```
功能： 短信的发送地址。
Type: String; Readable: true; Writable: false

#### let destinationPort

```cangjie
public let destinationPort: UInt16 = 0
```
功能： 如果发送数据消息，destinationPort 是必需的。否则是可选的。
Type: UInt16; Readable: true; Writable: false

#### let sendCallback

```cangjie
public let sendCallback: ?ISendShortMessageCallback = None
```
功能： 短信发送结果回调，返回短信发送的结果。
Type: ? ISendShortMessageCallback; Readable: true; Writable: false

#### let serviceCenter

```cangjie
public let serviceCenter: String = ""
```
功能： 短信中心地址。默认使用SIM卡中的短信中心地址。
Type: String; Readable: true; Writable: false

#### let slotId

```cangjie
public let slotId: Int32
```
功能： 用于发送短信的SIM卡槽ID： - 0：卡槽1。 - 1：卡槽2。
Type: Int32; Readable: true; Writable: false


### ShortMessage

class ShortMessage
```cangjie
public class ShortMessage { public let hasReplyPath: Bool public let isReplaceMessage: Bool public let isSmsStatusReportMessage: Bool public let messageClass: ShortMessageClass public let pdu: Array<Int32> public let protocolId: Int32 public let scAddress: String public let scTimestamp: Int64 public let status: Int32 public let visibleMessageBody: String public let visibleRawAddress: String }
```
功能： 短信实例。

#### let hasReplyPath

```cangjie
public let hasReplyPath: Bool
```
功能： 收到的短信是否包含“TP-Reply-Path”，默认为false。 “TP-Reply-Path”：设备根据发送SMS消息的短消息中心进行回复。
Type: Bool; Readable: true; Writable: false

#### let isReplaceMessage

```cangjie
public let isReplaceMessage: Bool
```
功能： 收到的短信是否为“替换短信”，默认为false。 “替换短信”有关详细信息，参见 “3GPP TS 23.040 9.2.3.9” 。
Type: Bool; Readable: true; Writable: false

#### let isSmsStatusReportMessage

```cangjie
public let isSmsStatusReportMessage: Bool
```
功能： 当前消息是否为“短信状态报告”，默认为false。 “短信状态报告”是一种特定格式的短信，被用来从Service Center到Mobile Station传送状态报告。
Type: Bool; Readable: true; Writable: false

#### let messageClass

```cangjie
public let messageClass: ShortMessageClass
```
功能： 短信类型。
Type: ShortMessageClass; Readable: true; Writable: false

#### let pdu

```cangjie
public let pdu: Array<Int32>
```
功能： SMS消息中的协议数据单元 （PDU）。
Type: Array<Int32>; Readable: true; Writable: false

#### let protocolId

```cangjie
public let protocolId: Int32
```
功能： 发送短信时使用的协议标识。
Type: Int32; Readable: true; Writable: false

#### let scAddress

```cangjie
public let scAddress: String
```
功能： 短消息服务中心（SMSC）地址。
Type: String; Readable: true; Writable: false

#### let scTimestamp

```cangjie
public let scTimestamp: Int64
```
功能： SMSC时间戳。
Type: Int64; Readable: true; Writable: false

#### let status

```cangjie
public let status: Int32
```
功能： SMS-STATUS-REPORT消息中的短信状态指示短信服务中心（SMSC）发送的短信状态。
Type: Int32; Readable: true; Writable: false

#### let visibleMessageBody

```cangjie
public let visibleMessageBody: String
```
功能： 短信正文。
Type: String; Readable: true; Writable: false

#### let visibleRawAddress

```cangjie
public let visibleRawAddress: String
```
功能： 发送者地址。
Type: String; Readable: true; Writable: false



## Enums

### ContentType

enum ContentType
```cangjie
public enum ContentType { | STRING(String) | UINT8ARR(Array<UInt8>) | ... }
```
功能： 短信类型。

#### STRING(String)

```cangjie
STRING(String)
```
功能： 字符串类型。

#### UINT8ARR(Array<UInt8>)

```cangjie
UINT8ARR(Array<UInt8>)
```
功能： 数据类型。


### SendSmsResult

enum SendSmsResult
```cangjie
public enum SendSmsResult <: Equatable<SendSmsResult> & ToString { | SEND_SMS_SUCCESS | SEND_SMS_FAILURE_UNKNOWN | SEND_SMS_FAILURE_RADIO_OFF | SEND_SMS_FAILURE_SERVICE_UNAVAILABLE | ... }
```
功能： 短信发送结果。

#### SEND_SMS_FAILURE_RADIO_OFF

```cangjie
SEND_SMS_FAILURE_RADIO_OFF
```
功能： 发送短信失败，原因为调制解调器关机。

#### SEND_SMS_FAILURE_SERVICE_UNAVAILABLE

```cangjie
SEND_SMS_FAILURE_SERVICE_UNAVAILABLE
```
功能： 发送短信失败，原因为网络不可用、不支持发送或接收短信。

#### SEND_SMS_FAILURE_UNKNOWN

```cangjie
SEND_SMS_FAILURE_UNKNOWN
```
功能： 发送短信失败，原因未知。

#### SEND_SMS_SUCCESS

```cangjie
SEND_SMS_SUCCESS
```
功能： 发送短信成功。


### ShortMessageClass

enum ShortMessageClass
```cangjie
public enum ShortMessageClass <: Equatable<ShortMessageClass> & ToString { | UNKNOWN | INSTANT_MESSAGE | OPTIONAL_MESSAGE | SIM_MESSAGE | FORWARD_MESSAGE | ... }
```
功能： 短信类型。

#### FORWARD_MESSAGE

```cangjie
FORWARD_MESSAGE
```
功能： 要转发到另一台设备的短信。

#### INSTANT_MESSAGE

```cangjie
INSTANT_MESSAGE
```
功能： 即时消息，收到后立即显示。

#### OPTIONAL_MESSAGE

```cangjie
OPTIONAL_MESSAGE
```
功能： 存储在设备或SIM卡上的短信。

#### SIM_MESSAGE

```cangjie
SIM_MESSAGE
```
功能： 包含SIM卡信息的短信，需要存储在SIM卡中。

#### UNKNOWN

```cangjie
UNKNOWN
```
功能： 未知类型。



## Types

### IDeliveryShortMessageCallback

type IDeliveryShortMessageCallback
```cangjie
public type IDeliveryShortMessageCallback =(Array<Int32>) -> Unit
```
功能： 回调实例，返回短信送达报告。 IDeliveryShortMessageCallback 是(Array<Int32>) -> Unit类型的别名。


### ISendShortMessageCallback

type ISendShortMessageCallback
```cangjie
public type ISendShortMessageCallback =(SendSmsResult) -> Unit
```
功能： 回调实例。 ISendShortMessageCallback 是( SendSmsResult ) -> Unit类型的别名。



