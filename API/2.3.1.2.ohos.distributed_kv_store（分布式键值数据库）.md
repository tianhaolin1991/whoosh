# ohos.distributed_kv_store（分布式键值数据库）

分布式键值数据库为应用程序提供不同设备间数据库的分布式协同能力。通过调用分布式键值数据库各个接口，应用程序可将数据保存到分布式键值数据库中，并可对分布式键值数据库中的数据进行增加、删除、修改、查询、同步等操作。

```cangjie
import kit.ArkData.*
```
## Classes

### ChangeNotification

class ChangeNotification
```cangjie
public class ChangeNotification <: ToString { public let insertEntries: ArrayList<Entry> public let updateEntries: ArrayList<Entry> public let deleteEntries: ArrayList<Entry> public let deviceId: String }
```
功能： 数据变更时通知的对象，包括数据插入的数据、更新的数据、删除的数据和设备ID。

#### let deleteEntries

```cangjie
public let deleteEntries: ArrayList<Entry>
```
功能： 数据删除记录。
Type: ArrayList< Entry >; Readable: true; Writable: false

#### let deviceId

```cangjie
public let deviceId: String
```
功能： 设备ID，此处为设备UUID。
Type: String; Readable: true; Writable: false

#### let insertEntries

```cangjie
public let insertEntries: ArrayList<Entry>
```
功能： 数据添加记录。
Type: ArrayList< Entry >; Readable: true; Writable: false

#### let updateEntries

```cangjie
public let updateEntries: ArrayList<Entry>
```
功能： 数据更新记录。
Type: ArrayList< Entry >; Readable: true; Writable: false


### DeviceKVStore

class DeviceKVStore
```cangjie
public class DeviceKVStore <: SingleKVStore {}
```
功能： 设备协同数据库，继承自SingleKVStore，提供查询数据和同步数据的方法。


### DistributedKVStore

class DistributedKVStore
```cangjie
public class DistributedKVStore {}
```
功能： 用于创建KVManager类。


### KVManager

class KVManager
```cangjie
public class KVManager {}
```
功能： 分布式键值数据库管理实例，用于获取分布式键值数据库的相关信息。在调用KVManager的方法前，需要先通过 createKVManager 构建一个KVManager实例。


### KVOptions

class KVOptions
```cangjie
public class KVOptions { public init (securityLevel: SecurityLevel, createIfMissing!: Bool = true, encrypt!: Bool = false, backup!: Bool = true, autoSync!: Bool = false, schema!: Schema = Schema()) }
```
功能： 用于提供创建数据库的配置信息。


### KVStoreResultSet

class KVStoreResultSet
```cangjie
public class KVStoreResultSet {}
```
功能： 提供获取数据库结果集的相关方法，包括查询和移动数据读取位置等。允许打开的结果集最大数量为8个。


### Query

class Query
```cangjie
public class Query { public init() }
```
功能： 使用谓词表示数据库查询，提供创建Query实例、查询数据库中的数据和添加谓词的方法。一个Query对象中谓词数量上限为256个。


### SingleKVStore

class SingleKVStore
```cangjie
public open class SingleKVStore {}
```
功能： SingleKVStore数据库实例，提供增加数据、删除数据和订阅数据变更、订阅数据同步完成的方法。



## Structs

### Entry

struct Entry
```cangjie
public struct Entry <: ToString { public var key: String public var value: KVValueType public init (key: String, value: KVValueType) }
```
功能： 存储在数据库中的键值对。


### FieldNode

struct FieldNode
```cangjie
public struct FieldNode { public var nullable: Bool = true public var default: String public var type_: Int32 = 0 public init (name: String) }
```
功能： 表示Schema实例的节点，提供定义存储在数据库中的值的方法。


### KVManagerConfig

struct KVManagerConfig
```cangjie
public struct KVManagerConfig { public init (context: StageContext, bundleName: String) }
```
功能： 提供KVManager实例的配置信息，包括调用方的包名和应用的上下文。


### Schema

struct Schema
```cangjie
public struct Schema { public var root: FieldNode = FieldNode("undefined") public var indexes: Array<String>=[] public var mode: Int32 = 0 public var skip: Int32 = 0 }
```
功能： 表示数据库模式，可以在创建或打开数据库时创建Schema对象并将它们放入 KVOptions 中。



## Enums

### KVSecurityLevel

enum KVSecurityLevel
```cangjie
public enum KVSecurityLevel { | S1 | S2 | S3 | S4 | ... }
```
功能： 数据库的安全级别枚举。

#### S1

```cangjie
S1
```
功能： 表示数据库的安全级别为低级别，数据的泄露、篡改、破坏、销毁可能会给个人或组织导致有限的不利影响。例如，性别、国籍，用户申请记录等。

#### S2

```cangjie
S2
```
功能： 表示数据库的安全级别为中级别，数据的泄露、篡改、破坏、销毁可能会给个人或组织导致严重的不利影响。例如，个人详细通信地址，姓名昵称等。

#### S3

```cangjie
S3
```
功能： 表示数据库的安全级别为高级别，数据的泄露、篡改、破坏、销毁可能会给个人或组织导致严重的不利影响。例如，个人实时精确定位信息、运动轨迹等。

#### S4

```cangjie
S4
```
功能： 表示数据库的安全级别为关键级别，业界法律法规中定义的特殊数据类型，涉及个人的最私密领域的信息，一旦泄露、篡改、破坏、销毁可能会给个人或组织造成重大不利影响的数据。例如，政治观点、宗教、和哲学信仰、工会成员资格、基因数据、生物信息、健康和性生活状况、性取向、设备认证鉴权、个人的信用卡等财务信息。


### SubscribeType

enum SubscribeType
```cangjie
public enum SubscribeType { | SUBSCRIBE_TYPE_LOCAL | SUBSCRIBE_TYPE_REMOTE | SUBSCRIBE_TYPE_ALL | ... }
```
功能： 订阅类型枚举。

#### SUBSCRIBE_TYPE_ALL

```cangjie
SUBSCRIBE_TYPE_ALL
```
功能： 表示订阅远端和本地数据变更。

#### SUBSCRIBE_TYPE_LOCAL

```cangjie
SUBSCRIBE_TYPE_LOCAL
```
功能： 表示订阅本地数据变更。

#### SUBSCRIBE_TYPE_REMOTE

```cangjie
SUBSCRIBE_TYPE_REMOTE
```
功能： 表示订阅远端数据变更。


### SyncMode

enum SyncMode
```cangjie
public enum SyncMode { | PULL_ONLY | PUSH_ONLY | PUSH_PULL | ... }
```
功能： 同步模式枚举。

#### PULL_ONLY

```cangjie
PULL_ONLY
```
功能： 表示只能从远端拉取数据到本端。

#### PUSH_ONLY

```cangjie
PUSH_ONLY
```
功能： 表示只能从本端推送数据到远端。

#### PUSH_PULL

```cangjie
PUSH_PULL
```
功能： 表示从本端推送数据到远端，然后从远端拉取数据到本端。


### KVValueType

enum KVValueType
```cangjie
public enum KVValueType <: ToString { | STRING(String) | INTEGER(Int32) | FLOAT(Float32) | BYTE_ARRAY(Array<Byte>) | BOOLEAN(Bool) | DOUBLE(Float64) | ... }
```
功能： 数据类型枚举。

#### BOOLEAN(Bool)

```cangjie
BOOLEAN(Bool)
```
功能： 表示值类型为布尔值。

#### BYTE_ARRAY(Array<Byte>)

```cangjie
BYTE_ARRAY(Array<Byte>)
```
功能： 表示值类型为字节数组。

#### DOUBLE(Float64)

```cangjie
DOUBLE(Float64)
```
功能： 表示值类型为Float64浮点数。

#### FLOAT(Float32)

```cangjie
FLOAT(Float32)
```
功能： 表示值类型为Float32浮点数。

#### INTEGER(Int32)

```cangjie
INTEGER(Int32)
```
功能： 表示值类型为Int32整数。

#### STRING(String)

```cangjie
STRING(String)
```
功能： 表示值类型为字符串。



