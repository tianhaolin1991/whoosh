# ohos.advertising.advertising（广告服务框架）

本模块提供广告操作能力，包括请求广告、展示广告。

```cangjie
import kit.AdsKit.*
```
## Functions

### public func getAdRequestBody(adParams: Array<AdRequestParams>, adOptions: AdOptions): String

```cangjie
public func getAdRequestBody(adParams: Array<AdRequestParams>, adOptions: AdOptions): String
```
功能： 请求广告响应体。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| Array< AdRequestParams > | 是 | 广告请求参数。 | adParams | - |
| AdOptions | 是 | 广告配置。 | adOptions | - |

**Returns:**

| type | description |
| --- | --- |
| String | 返回字符串类型的广告数据。 |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 advertising错误码 和 通用错误码 。

| code | description |
| --- | --- |
| 401 | Invalid input parameter. Possible causes: 1. Mandatory parameters are left unspecified. |
| 801 | Device not supported. |
| 21800004 | System internal error. |


**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.AdsKit.*

let adReqParamsArr: Array<AdRequestParams> = [AdRequestParams(adId: "testu7m3hc4gvm", adType: 3, adCount: 2,adWidth: 100, adHeight: 100)]
let adOptions: AdOptions = AdOptions(tagForChildProtection: -1, nonPersonalizedAd: 1, adContentClassification: "A")
try {
 let body: String = getAdRequestBody(adReqParamsArr, adOptions)
 AppLog.error(body)
} catch (e: BusinessException) {
 AppLog.info("get request ad body fail")
}
```

### public func showAd(advertisement: Advertisement, adDisplayoptions: AdDisplayOptions, context: ?StageContext): Unit

```cangjie
public func showAd(advertisement: Advertisement, adDisplayoptions: AdDisplayOptions, context: ?StageContext): Unit
```
功能： 展示全屏广告。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| Advertisement | 是 | 广告对象。 | advertisement | - |
| AdDisplayOptions | 是 | 广告展示参数。 | adDisplayoptions | - |
| ? StageContext | 是 | UIAbility的上下文环境 | context | - |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 advertising错误码 。

| code | description |
| --- | --- |
| 21800001 | System internal error. |
| 21800004 | Failed to display the ad. |


**Example:**

```cangjie
// index.cj

import ohos.base.*
import kit.AdsKit.*
import std.collection.HashMap

let adDisplayOptions: AdDisplayOptions = AdDisplayOptions(mute: false)
try {
 showAd(Advertisement(3, "32138728", false, false, false, HashMap<String, String>(), Array<Parameter>()),
 adDisplayOptions, Global.getStageContext()) // 需获取Context应用上下文，详见本文使用说明
 } catch (e: BusinessException) {
 AppLog.error("show ad failure")
}
```


## Classes

### AdDisplayOptions

class AdDisplayOptions
```cangjie
public class AdDisplayOptions { public AdDisplayOptions( public let customData!: ?String = None, public let userId!: ?String = None, public let useMobileDataReminder!: ?Bool = None, public let mute!: ?Bool = None, public let audioFocusType!: ?UInt32 = None, public let extraAttrs!: ?Array<Parameter> = None ) }
```
功能： 广告展示参数。

#### let audioFocusType

```cangjie
public let audioFocusType:?UInt32 = None
```
功能： 视频播放过程中获得音频焦点的场景类型。 - 0：视频播放静音、非静音时都获取焦点。 - 1：视频静音播放时不获取焦点。 - 2：视频播放静音、非静音时都不获取焦点。
Type: ?UInt32; Readable: true; Writable: false

#### let customData

```cangjie
public let customData:?String = None
```
功能： 媒体自定义数据。用于服务端通知媒体服务器某位用户因为与激励视频广告互动而应予以奖励，从而规避欺骗的行为。
Type: ?String; Readable: true; Writable: false

#### let extraAttrs

```cangjie
public let extraAttrs:?Array<Parameter>= None
```
功能： 自定义参数。 refreshTime：类型Int32，单位：ms，取值范围[30000, 120000]。AutoAdComponent组件可选自定义参数，用于控制广告的轮播时间间隔。填写了该参数，则广告按照参数配置的时间间隔轮播，否则广告不会轮播，只会展示广告响应中的第一个广告内容。
Type: ?Array< Parameter >; Readable: true; Writable: false

#### let mute

```cangjie
public let mute:?Bool = None
```
功能： 广告视频播放是否静音。 - true：静音播放。 - false：非静音播放。
Type: ?Bool; Readable: true; Writable: false

#### let useMobileDataReminder

```cangjie
public let useMobileDataReminder:?Bool = None
```
功能： 使用移动数据播放视频或下载应用时是否弹框通知用户。 - true：弹框通知。 - false：不弹框通知。
Type: ?Bool; Readable: true; Writable: false

#### let userId

```cangjie
public let userId:?String = None
```
功能： 媒体自定义用户id。用于服务端通知媒体服务器某位用户因为与激励视频广告互动而应予以奖励，从而规避欺骗的行为。
Type: ?String; Readable: true; Writable: false


### AdInteractionListener

class AdInteractionListener
```cangjie
public class AdInteractionListener { public AdInteractionListener( public let onStatusChanged: (status: String, ad: Advertisement, data: String) -> Unit ) }
```
功能： 广告状态变化回调。

#### let onStatusChanged

```cangjie
public let onStatusChanged:(status: String, ad: Advertisement, data: String) -> Unit
```
功能： 广告状态回调。
Type: (status: String, ad: Advertisement , data: String)->Unit; Readable: true; Writable: false


### AdLoadListener

class AdLoadListener
```cangjie
public class AdLoadListener { public AdLoadListener( public let onAdLoadSuccess: (ads: Array<Advertisement>) -> Unit, public let onAdLoadFailure: (errorCode: Int32, errorMsg: String) -> Unit ) }
```
功能： 单广告位广告请求回调。

#### let onAdLoadFailure

```cangjie
public let onAdLoadFailure:(errorCode: Int32, errorMsg: String) -> Unit
```
功能： 广告请求失败回调。
Type: (Int32,String)->Unit; Readable: true; Writable: false

#### let onAdLoadSuccess

```cangjie
public let onAdLoadSuccess:(ads: Array<Advertisement>) -> Unit
```
功能： 广告请求成功后回调。
Type: (ads:Array< Advertisement >)->Unit; Readable: true; Writable: false


### AdLoader

class AdLoader
```cangjie
public class AdLoader { public init(context: StageContext) }
```
功能： 提供加载广告的功能。


### AdOptions

class AdOptions
```cangjie
public class AdOptions { public AdOptions( public let tagForChildProtection!: ?Int32 = -1, public let adContentClassification!: ?String = None, public let nonPersonalizedAd!: ?UInt32 = None, public let extraAttrs!: ?Array<Parameter> = None ) }
```
功能： 广告配置参数。

#### let adContentClassification

```cangjie
public let adContentClassification:?String = None
```
功能： 设置广告内容分级上限。 - W：适合幼儿及以上年龄段观众的内容。 - PI：适合少儿及以上年龄段观众的内容。 - J：适合青少年及以上年龄段观众的内容。 - A：仅适合成人观众的内容。
Type: ?String; Readable: true; Writable: false

#### let extraAttrs

```cangjie
public let extraAttrs:?Array<Parameter>= None
```
功能： 自定义参数 - totalDuration：类型Int32，单位：s。贴片广告必填自定义参数，用于设置贴片广告展示时长。 - placementAdCountDownDesc：类型string。贴片广告可选自定义参数，用于设置贴片广告倒计时文案，该参数需要使用encodeURI()方法编码。填写了该参数，则展示倒计时文案，否则只展示倒计时。 - allowMobileTraffic：类型Int32。可选自定义参数，设置是否允许使用流量下载广告素材。0：不允许，1：允许，不设置以广告主设置为准。
Type: ?Array< Parameter >; Readable: true; Writable: false

#### let nonPersonalizedAd

```cangjie
public let nonPersonalizedAd:?UInt32 = None
```
功能： 设置是否只请求非个性化广告。 - 0：请求个性化广告与非个性化广告。 - 1：只请求非个性化广告。
Type: ?UInt32; Readable: true; Writable: false

#### let tagForChildProtection

```cangjie
public let tagForChildProtection:?Int32 = - 1
```
功能： 设置儿童保护标签。 - -1：您不希望表明您的广告内容是否需要符合COPPA的规定。 - 0：表明您的广告内容不需要符合COPPA的规定。 - 1：表明您的广告内容需要符合COPPA的规定（该广告请求无法获取到任何广告）。
Type: ?Int32; Readable: true; Writable: false


### AdRequestParams

class AdRequestParams
```cangjie
public class AdRequestParams { public AdRequestParams( public let adId!: String, public let adType!: ?UInt32 = None, public let adCount!: ?UInt32 = None, public let adWidth!: ?UInt32 = None, public let adHeight!: ?UInt32 = None, public let adSearchKeyword!: ?String = None, public let extraAttrs!: ?Array<Parameter> = None ) }
```
功能： 广告请求参数。

#### let adCount

```cangjie
public let adCount:?UInt32 = None
```
功能： 请求的广告数量。
Type: ?UInt32; Readable: true; Writable: false

#### let adHeight

```cangjie
public let adHeight:?UInt32 = None
```
功能： 广告位高度。
Type: ?UInt32; Readable: true; Writable: false

#### let adId

```cangjie
public let adId: String
```
功能： 广告位ID。
Type: String; Readable: true; Writable: false

#### let adSearchKeyword

```cangjie
public let adSearchKeyword:?String = None
```
功能： 广告关键字。
Type: ?String; Readable: true; Writable: false

#### let adType

```cangjie
public let adType:?UInt32 = None
```
功能： 请求的广告类型。 - 1：开屏广告。 - 3：原生广告。 - 7：激励广告。 - 8：banner广告。 - 12：插屏广告。 - 60：贴片广告。
Type: ?UInt32; Readable: true; Writable: false

#### let adWidth

```cangjie
public let adWidth:?UInt32 = None
```
功能： 广告位宽度。
Type: ?UInt32; Readable: true; Writable: false

#### let extraAttrs

```cangjie
public let extraAttrs:?Array<Parameter>= None
```
功能： 自定义参数。
Type: ?Array< Parameter >; Readable: true; Writable: false


### Advertisement

class Advertisement
```cangjie
public class Advertisement { public Advertisement( public let adType: UInt32, public let uniqueId: String, public let rewarded: Bool, public let shown: Bool, public let clicked: Bool, public let rewardVerifyConfig: HashMap<String, String>, public let extraAttrs: Array<Parameter> ) }
```
功能： 请求的广告内容。

#### let adType

```cangjie
public let adType: UInt32
```
功能： 广告类型。
Type: UInt32; Readable: true; Writable: false

#### let clicked

```cangjie
public let clicked: Bool
```
功能： 广告是否被点击。
Type: Bool; Readable: true; Writable: false

#### let extraAttrs

```cangjie
public let extraAttrs: Array<Parameter>
```
功能： 自定义参数。
Type: Array< Parameter >; Readable: true; Writable: false

#### let rewardVerifyConfig

```cangjie
public let rewardVerifyConfig: HashMap<String, String>
```
功能： 服务器验证参数。
Type: HashMap<String, String>; Readable: true; Writable: false

#### let rewarded

```cangjie
public let rewarded: Bool
```
功能： 广告是否获得奖励。
Type: Bool; Readable: true; Writable: false

#### let shown

```cangjie
public let shown: Bool
```
功能： 广告是否展示。
Type: Bool; Readable: true; Writable: false

#### let uniqueId

```cangjie
public let uniqueId: String
```
功能： 广告唯一标识。
Type: String; Readable: true; Writable: false


### MultiSlotsAdLoadListener

class MultiSlotsAdLoadListener
```cangjie
public class MultiSlotsAdLoadListener { public MultiSlotsAdLoadListener( public let onAdLoadSuccess: (adsMap: HashMap<String, Array<Advertisement>>) -> Unit, public let onAdLoadFailure: (errorCode: Int32, errorMsg: String) -> Unit ) }
```
功能： 多广告位广告请求回调。

#### let onAdLoadFailure

```cangjie
public let onAdLoadFailure:(errorCode: Int32, errorMsg: String) -> Unit
```
功能： 广告请求失败回调。
Type: (Int32, String)->Unit; Readable: true; Writable: false

#### let onAdLoadSuccess

```cangjie
public let onAdLoadSuccess:(adsMap: HashMap<String, Array<Advertisement>>) -> Unit
```
功能： 广告请求成功后回调。
Type: (HashMap<String,Array< Advertisement >>)->Unit; Readable: true; Writable: false


### Parameter

class Parameter
```cangjie
public class Parameter { public Parameter( let key: String, let value: ValueType ) }
```
功能： 用于储存数据的键值对类型。



## Enums

### ValueType

enum ValueType
```cangjie
public enum ValueType { | INT(Int32) | BOOL(Bool) | STRING(String) | ... }
```
功能： 数据类型枚举。

#### BOOL(Bool)

```cangjie
BOOL(Bool)
```
功能： 表示值类型为布尔值。

#### INT(Int32)

```cangjie
INT(Int32)
```
功能： 表示值类型为Int32整数。

#### STRING(String)

```cangjie
STRING(String)
```
功能： 表示值类型为字符串。



