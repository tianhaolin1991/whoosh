# 焦点控制

自定义组件的走焦效果，可设置组件是否走焦和具体的走焦顺序，tab键或者方向键切换焦点。

## Functions

### public func defaultFocus(isDefaultFocus: Bool): This

```cangjie
public func defaultFocus(isDefaultFocus: Bool): This
```
功能： 设置当前组件是否为当前页面上的默认焦点。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| Bool | 是 | 设置当前组件是否为当前页面上的默认焦点，仅在初次创建的页面第一次进入时生效。 初始值:false。 说明： 值为true则表示为默认焦点，值为false无效。 | isDefaultFocus | - |

### public func focusable(isFocusable: Bool): This

```cangjie
public func focusable(isFocusable: Bool): This
```
功能： 设置当前组件是否可以获焦。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| Bool | 是 | 当前组件是否可以获焦。true表示组件可以获焦，false表示组件不可获焦。 说明： 存在默认交互逻辑的组件例如 Button 、 TextInput 等，默认即为可获焦， Text 、 Image 等组件则默认状态为不可获焦。不可获焦状态下，无法触发 焦点事件 。 | isFocusable | - |

### public func focusOnTouch(isFocusOnTouch: Bool): This

```cangjie
public func focusOnTouch(isFocusOnTouch: Bool): This
```
功能： 设置当前组件是否支持点击获焦能力。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| Bool | 是 | 当前组件是否支持点击获焦能力。true表示组件支持点击获焦，false表示不支持点击获焦。 初始值：false。 说明： 仅在组件可点击时才能正常获取焦点。 | isFocusOnTouch | - |

### public func focusBox(style: FocusBoxStyle): This

```cangjie
public func focusBox(style: FocusBoxStyle): This
```
功能： 设置当前组件系统焦点框样式。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| FocusBoxStyle | 是 | 当前组件系统焦点框样式。 说明： 该样式仅影响走焦状态下展示了系统焦点框的组件。 | style | - |

### public func focusScopePriority(scopeId: String, priority!: FocusPriority = FocusPriority.AUTO): This

```cangjie
public func focusScopePriority(scopeId: String, priority!: FocusPriority = FocusPriority.AUTO): This
```
功能： 设置当前组件在指定容器内获焦的优先级。需要配合focusScopeId一起使用。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| String | 是 | 当前组件设置的获焦优先级生效的容器组件的id标识。 说明： 1.当前组件必须在scopeId所标识的容器内或者当前组件所属容器在scopeId所标识的容器内。 2.组件不可重复设置多个优先级。 3.设置了focusScopeId的容器组件不可设置优先级。 | scopeId | - |
| FocusPriority | 否 | 命名参数。 获焦优先级。 说明： priority不设置则组件为默认AUTO优先级。 优先级对走焦以及获焦组件的影响： 1.容器整体获焦（层级页面切换/焦点切换到焦点组/容器组件使用requestFocus申请焦点）时，若容器内存在优先级为PREVIOUS的组件，则优先级为PREVIOUS的组件获焦，否则，由容器内上次获焦的组件获焦。 2.容器非整体获焦（非焦点组场景下使用tab键/方向键走焦）时，若容器为首次获焦，则容器内优先级最高的组件获焦，若容器非首次获焦，不考虑优先级按照位置顺序走焦。 | priority | FocusPriority.AUTO |

### public func focusScopeId(id: String, isGroup!: Bool = false, arrowStepOut!: Bool = true): This

```cangjie
public func focusScopeId(id: String, isGroup!: Bool = false, arrowStepOut!: Bool = true): This
```
功能： 设置当前容器组件的id标识，设置当前容器组件是否为焦点组。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| String | 是 | 当前容器组件的id标识。 说明： 单个层级页面下，id标识全局唯一，不可重复。 | id | - |
| Bool | 否 | 命名参数。 当前容器组件是否为焦点组。 说明： 焦点组不可嵌套，不可重复配置。 焦点组不能和tabIndex混用。 配置焦点组的目的时使得容器及容器内的元素可以按照焦点组规则走焦。焦点组走焦规则： 1.焦点组容器内只能通过方向键走焦，tab键会使焦点跳出焦点组容器。 2.通过方向键使焦点从焦点组容器外切换到焦点组容器内时，若焦点组容器内存在优先级为PREVIOUS的组件，则优先级为PREVIOUS的组件获焦，否则，由焦点组容器内上次获焦的组件获焦。 | isGroup | false |
| Bool | 否 | 命名参数。 能否使用方向键走焦出当前焦点组。true表示可以使用方向键走焦出当前焦点组，false表示不能使用方向键走焦出当前焦点组。 | arrowStepOut | true |

### public func tabIndex(index: Int32): This

```cangjie
public func tabIndex(index: Int32): This
```
功能： 自定义组件tab键走焦能力。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| Int32 | 是 | 自定义组件tab键走焦能力。若有配置了tabIndex大于0的组件，则tab键走焦只会在tabIndex大于0的组件内按照tabIndex的值从小到大并循环依次走焦。若没有配置tabIndex大于0的组件，则tabIndex等于0的组件按照组件预设的走焦规则走焦。 UiExtension组件未适配tabIndex，在含有UiExtension组件的页面使用tabIndex会导致走焦错乱。 - tabIndex >= 0：表示元素是可聚焦的，并且可以通过tab键走焦来访问到该元素。 - tabIndex < 0（通常是tabIndex = -1）：表示元素是可聚焦的，但是不能通过tab键走焦来访问到该元素。 初始值：0。 说明： tabIndex与focusScopeId不能混用。 | index | - |

### public func groupDefaultFocus(isGroupDefaultFocus: Bool): This

```cangjie
public func groupDefaultFocus(isGroupDefaultFocus: Bool): This
```
功能： 设置当前组件是否为当前组件所在容器获焦时的默认焦点。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| Bool | 是 | 当前组件是否为当前组件所在容器获焦时的默认焦点，仅在初次创建容器节点第一次获焦时生效。true表示当前组件为所在容器获焦时的默认焦点，false表示当前组件不是所在容器获焦时的默认焦点。 初始值：false 说明： 必须与tabIndex联合使用，当某个容器设置了 tabIndex ，且容器内某子组件或容器自身设置了groupDefaultFocus(true)，当该容器首次TAB键获焦时，会自动将焦点转移至该指定的组件上。若容器内（包含容器本身）有多个组件设置了groupDefaultFocus(true)，则以组件树深度遍历找到的第一个组件为最终结果。 | isGroupDefaultFocus | - |


## Classes

### FocusControl

class FocusControl
```cangjie
public class FocusControl { }
```
功能： 焦点控制模块。


### FocusBoxStyle

class FocusBoxStyle
```cangjie
public class FocusBoxStyle { public FocusBoxStyle ( public var margin!: ?Length = None, public var strokeColor!: ?ColorMetrics = None, public var strokeWidth!: ?Length = None ) }
```
功能： 系统焦点框样式。

#### var margin

```cangjie
public var margin: ?Length = None
```
功能： 焦点框相对组件边缘的距离。正数代表外侧，负数代表内侧。不支持百分比。
Type: Length; Readable: true; Writable: true

#### var strokeColor

```cangjie
public var strokeColor: ?ColorMetrics = None
```
功能： 焦点框颜色。
Type: ColorMetrics; Readable: true; Writable: true

#### var strokeWidth

```cangjie
public var strokeWidth: ?Length = None
```
功能： 焦点框宽度。不支持负数与百分比。
Type: Length; Readable: true; Writable: true


### ColorMetrics

class ColorMetrics
```cangjie
public class ColorMetrics { public prop color: String public prop red: UInt8 public prop green: UInt8 public prop blue: UInt8 public prop alpha: UInt8 }
```
功能： 用于混合颜色。

#### prop color

```cangjie
public prop color: String
```
功能： 获取ColorMetrics的颜色，返回的是rgba字符串的格式。
Type: String; Readable: true; Writable: false

#### prop red

```cangjie
public prop red: UInt8
```
功能： 获取ColorMetrics颜色的R分量（红色）。
Type: UInt8; Readable: true; Writable: false

#### prop green

```cangjie
public prop green: UInt8
```
功能： 获取ColorMetrics颜色的G分量（绿色）。
Type: UInt8; Readable: true; Writable: false

#### prop blue

```cangjie
public prop blue: UInt8
```
功能： 获取ColorMetrics颜色的B分量（蓝色）。
Type: UInt8; Readable: true; Writable: false

#### prop alpha

```cangjie
public prop alpha: UInt8
```
功能： 获取ColorMetrics颜色的A分量（透明度）。
Type: UInt8; Readable: true; Writable: false



## Enums

### FocusPriority

enum FocusPriority
```cangjie
public enum FocusPriority { | AUTO | PRIOR | PREVIOUS }
```
功能： 获焦优先级。

#### AUTO

```cangjie
AUTO
```
功能： 默认的优先级，缺省时组件的获焦优先级。

#### PRIOR

```cangjie
PRIOR
```
功能： 容器内优先获焦的优先级。优先级高于AUTO。

#### PREVIOUS

```cangjie
PREVIOUS
```
功能： 上一次容器整体失焦时获焦节点的优先级。优先级高于PRIOR。



## Examples

```cangjie
package ohos_app_cangjie_entry
import kit.UIKit.*
import ohos.state_macro_manage.*

@Entry
@Component
class EntryView {
 @State
 var oneButtonColor: UInt32 = 0xFFC0CB
 @State
 var twoButtonColor: UInt32 = 0x87CEFA
 @State
 var threeButtonColor: UInt32 = 0x90EE90
 @State
 var fourButtonColor: UInt32 = 0x5DD55D
 @State
 var fiveButtonColor: UInt32 = 0x1E90FF
 @State
 var rowBoxColor: UInt32 = 0xFFFFFF
 @State
 var idList: Array<String> = ["A", "B", "C", "D", "E", "F"]

 func build() {
 // button 组件默认可获焦
 Column(20) {
 Row() {
 // 默认焦点，并且点击可获焦
 Button("Hello Cangjie A")
 .onClick {
 evt => AppLog.info("Hello Cangjie A")
 }
 .backgroundColor(oneButtonColor)
 .width(400.px)
 .height(150.px)
 .margin(5.px)
 .fontColor(Color.BLACK)
 .focusOnTouch(true)
 .defaultFocus(true)
 .onFocus({
 => oneButtonColor = 0xFF0000
 })
 .onBlur({
 => oneButtonColor = 0xFFC0CB
 })
 .tabIndex(1)
 .id(this.idList[0])
 .key(this.idList[0])
 // 不支持点击获焦，但是默认可获焦
 Button("Hello Cangjie B")
 .onClick {
 evt => AppLog.info("Hello Cangjie B")
 }
 .backgroundColor(twoButtonColor)
 .width(400.px)
 .height(150.px)
 .fontColor(Color.BLACK)
 .margin(5.px)
 .focusOnTouch(false)
 .onFocus({
 => twoButtonColor = 0xFF0000
 })
 .onBlur({
 => twoButtonColor = 0x87CEFA
 })
 .tabIndex(2)
 .id(this.idList[1])
 .key(this.idList[1])
 }
 Row() {
 // 不支持获焦
 Button("Hello Cangjie C")
 .onClick {
 evt => AppLog.info("Hello Cangjie C")
 }
 .backgroundColor(threeButtonColor)
 .width(400.px)
 .height(150.px)
 .margin(5.px)
 .fontColor(Color.BLACK)
 .focusable(false)
 .onFocus({
 => threeButtonColor = 0xFF0000
 })
 .onBlur({
 => threeButtonColor = 0x90EE90
 })
 .tabIndex(3)
 .id(this.idList[2])
 .key(this.idList[2])
 // 可获焦，并且支持点击获焦
 Button("Hello Cangjie D")
 .onClick {
 evt => AppLog.info("Hello Cangjie D")
 }
 .backgroundColor(fourButtonColor)
 .width(400.px)
 .height(150.px)
 .margin(5.px)
 .fontColor(Color.BLACK)
 .focusable(true)
 .focusOnTouch(true)
 .onFocus({
 => fourButtonColor = 0xFF0000
 })
 .onBlur({
 => fourButtonColor = 0x5DD55D
 })
 .tabIndex(4)
 .id(this.idList[3])
 .key(this.idList[3])
 }
 Row() {
 // 父级组件获焦时的默认焦点
 Button("Hello Cangjie E")
 .onClick {
 evt => AppLog.info("Hello Cangjie E")
 }
 .backgroundColor(fiveButtonColor)
 .width(400.px)
 .height(150.px)
 .margin(20.px)
 .fontColor(Color.BLACK)
 .onFocus({
 => fiveButtonColor = 0xFF0000
 })
 .onBlur({
 => fiveButtonColor = 0x1E90FF
 })
 .groupDefaultFocus(true)
 .id(this.idList[4])
 .key(this.idList[4])
 }
 .tabIndex(4)
 .focusable(true)
 .borderWidth(1.5)
 .borderColor(rowBoxColor)
 .borderStyle(BorderStyle.Solid)
 .onFocus({
 => rowBoxColor = 0x000000
 })
 .onBlur({
 => rowBoxColor = 0xFFFFFF
 })

 Row() {
 // 点击让D组件获焦
 Button("RequestFocus-D")
 .width(400.px)
 .height(150.px)
 .margin(20.px)
 .fontColor(Color.BLACK)
 .focusable(true)
 .onClick {
 let selectId = this.idList[3]
 let result = FocusControl.requestFocus(selectId)
 if (result) {
 AppLog.info("Request success")
 } else {
 AppLog.info("Request failed")
 }
 }
 }

 Row(20) {
 Column(20) {
 Column(5) {
 Button("Group1")
 .width(165)
 .height(40)
 .fontColor(Color.WHITE)
 .id("b1")
 .key("b1")
 .focusOnTouch(true)
 Row(5) {
 Button().width(80).height(40).fontColor(Color.WHITE).id("b2").key("b2")
 Button().width(80).height(40).fontColor(Color.WHITE).id("b3").key("b3")
 }
 Row(5) {
 Button().width(80).height(40).fontColor(Color.WHITE).id("b4").key("b4")
 Button().width(80).height(40).fontColor(Color.WHITE).id("b5").key("b5")
 }
 }.borderWidth(2).borderColor(Color.RED).borderStyle(BorderStyle.Dashed)
 Column(5) {
 Button("Group2").width(165).height(40).fontColor(Color.WHITE).id("b6").key("b6")
 Row(5) {
 Button().width(80).height(40).fontColor(Color.WHITE).id("b7").key("b7")
 Button("PRIOR")
 .width(80)
 .height(40)
 .fontColor(Color.WHITE)
 .focusScopePriority("ColumnScope1", priority: FocusPriority.PRIOR)
 .focusBox(
 FocusBoxStyle(
 margin: 20.px,
 strokeColor: ColorMetrics.resourceColor(Color.RED),
 strokeWidth: 20.px
 )
 )
 .id("b8")
 .key("b8")
 }
 Row(5) {
 Button().width(80).height(40).fontColor(Color.WHITE).id("b9").key("b9")
 Button().width(80).height(40).fontColor(Color.WHITE).id("b10").key("b10")
 }
 }.borderWidth(2).borderColor(Color.GREEN).borderStyle(BorderStyle.Dashed)
 }.focusScopeId("ColumnScope1")
 Column(5) {
 Button("Group3")
 .width(165)
 .height(40)
 .fontColor(Color.WHITE)
 .id("b11")
 .key("b11")
 .focusOnTouch(true)
 Row(5) {
 Button().width(80).height(40).fontColor(Color.WHITE).id("b12").key("b12")
 Button().width(80).height(40).fontColor(Color.WHITE).id("b13").key("b13")
 }
 Button("PREVIOUS")
 .width(165)
 .height(40)
 .fontColor(Color.WHITE)
 .focusScopePriority("ColumnScope2", priority: FocusPriority.PREVIOUS)
 .id("b14")
 .key("b14")
 Row(5) {
 Button().width(80).height(40).fontColor(Color.WHITE).id("b15").key("b15")
 Button().width(80).height(40).fontColor(Color.WHITE).id("b16").key("b16")
 }
 Button().width(165).height(40).fontColor(Color.WHITE).id("b17").key("b17")
 Row(5) {
 Button().width(80).height(40).fontColor(Color.WHITE).id("b18").key("b18")
 Button().width(80).height(40).fontColor(Color.WHITE).id("b19").key("b19")
 }
 }
 .borderWidth(2)
 .borderColor(Color.GRAY)
 .borderStyle(BorderStyle.Dashed)
 .focusScopeId("ColumnScope2", isGroup: true) // Column2为焦点组
 }
 }.width(100.percent).margin(top: 20)
 }
}
```

