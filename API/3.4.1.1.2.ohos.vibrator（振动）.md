# ohos.vibrator（振动）

vibrator模块提供控制马达振动启停的能力。

```cangjie
import kit.SensorServiceKit.*
```
## Functions

### public func isHdHapticSupported(): Bool

```cangjie
public func isHdHapticSupported(): Bool
```
功能： 查询是否支持高清振动。

**Returns:**

| type | description |
| --- | --- |
| Bool | 返回对象。 |

**Example:**

```cangjie
// index.cj

import kit.SensorServiceKit.*
import ohos.base.*

let ret = isHdHapticSupported()
AppLog.info("the ret is ${ret}")
```

### public func isSupportEffect(effectId: EffectId): Bool

```cangjie
public func isSupportEffect(effectId: EffectId): Bool
```
功能： 查询是否支持预设的振动效果。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| EffectId | 是 | 是否预设的振动效果。 | effectId | - |

**Returns:**

| type | description |
| --- | --- |
| Bool | 返回对象。当返回true则表示支持该effectId，否则不支持。 |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 振动错误码 和 通用错误码 。

| code | description |
| --- | --- |
| 401 | Parameter error.Possible causes: 1. Mandatory parameters are left unspecified;2. Incorrect parameter types;3. Parameter verification failed. |
| 14600101 | Device operation failed. |


**Example:**

```cangjie
// index.cj

import kit.SensorServiceKit.*
import ohos.base.*

try {
 let ret = isSupportEffect(EFFECT_CLOCK_TIMER)
 AppLog.info("the ret is ${ret}")
} catch (e: Exception) {
 AppLog.error("test_isSupportEffect :${e.message.toString()}")
}
```

### public func startVibration(effect: VibrateEffect, attribute: VibrateAttribute): Unit

```cangjie
public func startVibration(effect: VibrateEffect, attribute: VibrateAttribute): Unit
```
功能： 根据指定的振动效果和振动属性触发马达振动。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| VibrateEffect | 是 | 马达振动效果，支持三种： 1、 VibrateTime ：按照指定持续时间触发马达振动； 2、 VibratePreset ：按照预置振动效果触发马达振动； 3、 VibrateFromFile ：按照自定义振动配置文件触发马达振动。 | effect | - |
| VibrateAttribute | 是 | 马达振动属性。 | attribute | - |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 振动错误码 和 通用错误码 。

| code | description |
| --- | --- |
| 201 | Permission denied. |
| 401 | Parameter error.Possible causes: 1. Mandatory parameters are left unspecified;2. Incorrect parameter types;3. Parameter verification failed. |
| 801 | Capability not supported. |
| 14600101 | Device operation failed. |


**Example:**

```cangjie
// index.cj

import kit.SensorServiceKit.*
import ohos.base.*

let vibrateTime = VibrateTime("time", 1000)
let attribute = VibrateAttribute(ALARM, id: 0)
try {
 startVibration(vibrateTime, attribute)
} catch (e: Exception) {
 AppLog.error("test_startVibration :${e.message.toString()}")
}
```

### public func stopVibration(stopMode: Option<VibratorStopMode>): Unit

```cangjie
public func stopVibration(stopMode: Option<VibratorStopMode>): Unit
```
功能： 按照指定模式停止马达振动。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| Option<VibratorStopMode> | 是 | 当stopMode是Some类型时，可以指定停止振动模式，支持两种： VIBRATOR_STOP_MODE_TIME：停止固定时长振动； VIBRATOR_STOP_MODE_PRESET：停止预置振动。当stopMode是None类型时，可以停止任何振动模式。 | stopMode | - |

**Exceptions:**

- **BusinessException**: BusinessException：对应错误码的详细介绍请参见 通用错误码 。

| code | description |
| --- | --- |
| 201 | Permission denied. |
| 401 | Parameter error.Possible causes: 1. Mandatory parameters are left unspecified;2. Incorrect parameter types;3. Parameter verification failed. |


**Example:**

```cangjie
// index.cj

import kit.SensorServiceKit.*
import ohos.base.*

let vibrateTime = VibrateTime("time", 1000)
let attribute = VibrateAttribute(ALARM, id: 0)
try {
 startVibration(vibrateTime, attribute)
} catch (e: Exception) {
 AppLog.error("test_startVibration_time :${e.message.toString()}")
}
try {
 // 按照VIBRATOR_STOP_MODE_TIME模式停止振动
 stopVibration(Some(VibratorStopMode.VIBRATOR_STOP_MODE_TIME))
} catch (e: Exception) {
 AppLog.error("test_stopVibration_time :${e.message.toString()}")
}
```


## Interfaces

### VibrateEffect

interface VibrateEffect
```cangjie
public interface VibrateEffect { prop effectType: String }
```
功能： 马达振动效果。

#### prop effectType

```cangjie
prop effectType: String
```
功能： 马达振动效果类型。
Type: String; Readable: true; Writable: false



## Classes

### HapticFileDescriptor

class HapticFileDescriptor
```cangjie
public class HapticFileDescriptor { public var fd: Int32 public var offSet: Int64 public var length: Int64 public init(fd: Int32, offSet!: Int64 = 0, length!: Int64 = FileFs.stat(fd).size - offSet) }
```
功能： 自定义振动配置文件的描述符，必须确认资源文件可用，其参数可通过 文件管理API 从沙箱路径获取或者通过 资源管理API 从HAP资源获取。使用场景：振动序列被存储在一个文件中，需要根据偏移量和长度进行振动，振动序列存储格式。

#### var fd

```cangjie
public var fd: Int32
```
功能： 资源文件描述符。
Type: Int32; Readable: true; Writable: true

#### var length

```cangjie
public var length: Int64
```
功能： 资源长度，单位为字节。
Type: Int64; Readable: true; Writable: true

#### var offSet

```cangjie
public var offSet: Int64
```
功能： 距文件起始位置的偏移量，单位为字节。
Type: Int64; Readable: true; Writable: true


### VibrateAttribute

class VibrateAttribute
```cangjie
public class VibrateAttribute { public var usage: Usage public var id: Int32 public init(usage: Usage, id!: Int32 = 0) }
```
功能： 马达振动属性。

#### var id

```cangjie
public var id: Int32
```
功能： 振动器id， 默认值为0。
Type: Int32; Readable: true; Writable: true

#### var usage

```cangjie
public var usage: Usage
```
功能： 马达振动的使用场景。
Type: Usage; Readable: true; Writable: true


### VibrateFromFile

class VibrateFromFile
```cangjie
public class VibrateFromFile <: VibrateEffect { public var fileType: String public var hapticFd: HapticFileDescriptor public init(fileType: String, hapticFd: HapticFileDescriptor) }
```
功能： 自定义振动类型，仅部分设备支持，当设备不支持此振动类型时，返回错误码，详见 通用错误码 。

#### prop effectType

```cangjie
public prop effectType: String
```
功能： 马达振动效果类型。
Type: String; Readable: true; Writable: false

#### var fileType

```cangjie
public var fileType: String
```
功能： 值为'file'，按照振动配置文件触发马达振动。
Type: String; Readable: true; Writable: true

#### var hapticFd

```cangjie
public var hapticFd: HapticFileDescriptor
```
功能： 振动配置文件的描述符。
Type: HapticFileDescriptor; Readable: true; Writable: true


### VibratePreset

class VibratePreset
```cangjie
public class VibratePreset <: VibrateEffect { public var presetType: String public var effectId: String public var count: Int32 public var intensity: Int32 public init(presetType: String, effectId: String, count!: Int32 = 1, intensity!: Int32 = 100) }
```
功能： 预置振动类型。

#### prop effectType

```cangjie
public prop effectType: String
```
功能： 马达振动效果类型。
Type: String; Readable: true; Writable: false

#### var count

```cangjie
public var count: Int32
```
功能： 可选参数，振动的重复次数，默认值为1。
Type: Int32; Readable: true; Writable: true

#### var effectId

```cangjie
public var effectId: String
```
功能： 预置的振动效果ID。
Type: String; Readable: true; Writable: true

#### var intensity

```cangjie
public var intensity: Int32
```
功能： 可选参数，振动调节强度，范围为0到100，默认值为100。
Type: Int32; Readable: true; Writable: true

#### var presetType

```cangjie
public var presetType: String
```
功能： 值为'preset'，按照预置振动效果触发马达振动。
Type: String; Readable: true; Writable: true


### VibrateTime

class VibrateTime
```cangjie
public class VibrateTime <: VibrateEffect { public var timeType: String public var duration: Int32 public init(timeType: String, duration: Int32) }
```
功能： 固定时长振动类型。

#### prop effectType

```cangjie
public prop effectType: String
```
功能： 马达振动效果类型。
Type: String; Readable: true; Writable: false

#### var duration

```cangjie
public var duration: Int32
```
功能： 马达持续振动时长，单位ms。
Type: Int32; Readable: true; Writable: true

#### var timeType

```cangjie
public var timeType: String
```
功能： 值为'time'，按照指定持续时间触发马达振动。
Type: String; Readable: true; Writable: true



## Enums

### EffectId

enum EffectId
```cangjie
public enum EffectId <: ToString & Equatable<EffectId> { | EFFECT_CLOCK_TIMER | ... }
```
功能： 预置的振动效果。

#### EFFECT_CLOCK_TIMER

```cangjie
EFFECT_CLOCK_TIMER
```
功能： 描述用户调整计时器时的振动效果。


### HapticFeedback

enum HapticFeedback
```cangjie
public enum HapticFeedback <: ToString & Equatable<HapticFeedback> { | EFFECT_SOFT | EFFECT_HARD | EFFECT_SHARP | ... }
```
功能： 简单而通用的振动效果。

#### EFFECT_HARD

```cangjie
EFFECT_HARD
```
功能： 较沉重的振动效果，频率居中。

#### EFFECT_SHARP

```cangjie
EFFECT_SHARP
```
功能： 较尖锐的振动效果，频率偏高。

#### EFFECT_SOFT

```cangjie
EFFECT_SOFT
```
功能： 较松散的振动效果，频率偏低。


### Usage

enum Usage
```cangjie
public enum Usage <: ToString & Equatable<Usage> { | UNKNOWN | ALARM | RING | NOTIFICATION | COMMUNICATION | TOUCH | MEDIA | PHYSICALFEEDBACK | SIMULATEREALITY | ... }
```
功能： 振动使用场景。

#### ALARM

```cangjie
ALARM
```
功能： 用于警报场景。

#### COMMUNICATION

```cangjie
COMMUNICATION
```
功能： 用于通信场景。

#### MEDIA

```cangjie
MEDIA
```
功能： 用于多媒体场景。

#### NOTIFICATION

```cangjie
NOTIFICATION
```
功能： 用于通知场景。

#### PHYSICALFEEDBACK

```cangjie
PHYSICALFEEDBACK
```
功能： 用于物理反馈场景。

#### RING

```cangjie
RING
```
功能： 用于铃声场景。

#### SIMULATEREALITY

```cangjie
SIMULATEREALITY
```
功能： 用于模拟现实场景。

#### TOUCH

```cangjie
TOUCH
```
功能： 用于触摸场景。

#### UNKNOWN

```cangjie
UNKNOWN
```
功能： 没有明确使用场景，最低优先级。


### VibratorStopMode

enum VibratorStopMode
```cangjie
public enum VibratorStopMode <: ToString & Equatable<VibratorStopMode> { | VIBRATOR_STOP_MODE_TIME | VIBRATOR_STOP_MODE_PRESET | ... }
```
功能： 停止振动的模式。

#### VIBRATOR_STOP_MODE_PRESET

```cangjie
VIBRATOR_STOP_MODE_PRESET
```
功能： 停止预置EffectId的振动。

#### VIBRATOR_STOP_MODE_TIME

```cangjie
VIBRATOR_STOP_MODE_TIME
```
功能： 停止duration模式的振动。



