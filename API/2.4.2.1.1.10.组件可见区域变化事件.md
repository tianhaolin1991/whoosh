# 组件可见区域变化事件

组件可见区域变化事件是组件在屏幕中的显示区域面积变化时触发的事件，提供了判断组件是否完全或部分显示在屏幕中的能力，适用于广告曝光埋点之类的场景。

## Functions

### public func onVisibleAreaChange(ratios: Array<Float64>, callback: (Bool, Float64)->Unit): This

```cangjie
public func onVisibleAreaChange(ratios: Array<Float64>, callback: (Bool, Float64)->Unit): This
```
功能： 组件可见区域变化时触发的事件。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| Array<Float64> | 是 | 阈值数组。其中，每个阈值代表组件可见面积（即组件在屏幕显示区的面积，只计算父组件内的面积，超出父组件部分不会计算）与组件自身面积的比值。当组件可见面积与自身面积的比值接近阈值时，均会触发该回调。每个阈值的取值范围为[0.0, 1.0]，如果开发者设置的阈值超出该范围，则会实际取值0.0或1.0。 说明： 当数值接近边界0和1时，将会按照误差不超过0.001的规则进行舍入。例如，0.9997会被近似为1。 | ratios | - |
| (Bool, Float64)->Unit | 是 | 组件可见区域变化事件的回调。参数一：表示组件的可见面积与自身面积的比值与上一次变化相比的情况，比值变大为true，比值变小为false。参数二：触发回调时，组件可见面积与自身面积的比值。 | callback | - |


## Examples

```cangjie
package ohos_app_cangjie_entry
import kit.UIKit.*
import ohos.state_macro_manage.*
import std.collection.ArrayList

@Entry
@Component
class EntryView {
 @State var testTextStr: String = "test"
 @State var testRowStr: String = "test"
 @State var sizeValue: String = ""
 let scroller = Scroller()
 var arr: ArrayList<String> = ArrayList(["0", "1", "2", "3", "4", "5", "6", "7", "8", "9"])

 func build() {
 Stack(Alignment.TopStart) {
 Column {
 Column() {
 Text(this.testTextStr)
 .fontSize(20)

 Text(this.testRowStr)
 .fontSize(20)
 }
 .height(100)
 .backgroundColor(Color.GRAY)
 .opacity(0.3)
 }
 Scroll(this.scroller) {
 Column() {
 Text("Test Text Visible Change")
 .fontSize(20)
 .height(200)
 .margin(20)
 .backgroundColor(Color.GREEN)
 // 通过设置ratios为[0.0, 1.0]，实现当组件完全显示或完全消失在屏幕中时触发回调
 .onVisibleAreaChange([0.0, 1.0], {isVisible, currentRatio =>
 this.sizeValue = isVisible.toString() + ", currentRatio:" + currentRatio.toString()
 if (isVisible && currentRatio >= 1.0) {
 this.testTextStr = "Test Text is fully visible"
 Text("Test Text is fully visible. currentRatio:" + currentRatio.toString())
 }

 if (!isVisible && currentRatio <= 0.0) {
 this.testTextStr = "Test Text is completely invisible"
 Text("Test Text is completely invisible.")
 }
 })
 Text("Test Text isVisible: " + this.sizeValue)

 ForEach(this.arr, itemGeneratorFunc: {item: String, idx: Int64 =>
 Text(item.toString())
 .width(90.percent)
 .height(150)
 .backgroundColor(0xFFFFFF)
 .borderRadius(15)
 .fontSize(16)
 .textAlign(TextAlign.Center)
 .margin(top: 10)
 })
 }
 }
 .backgroundColor(0x317aff)
 .scrollable(ScrollDirection.Vertical)
 .scrollBar(BarState.On)
 .scrollBarColor(Color.GRAY)
 .scrollBarWidth(10)
 .onScrollEdge({ edge =>
 match(edge) {
 case Edge.Top => nativeLog("Top")
 case Edge.Bottom => nativeLog("Bottom")
 case _ => nativeLog("None")
 }
 })
 }
}
}
```

