# ImageAnimator

提供帧动画组件来实现逐帧播放图片的能力，可以配置需要播放的图片列表，每张图片可以配置时长。

## Component Constructors

### public init()

```cangjie
public init()
```
功能： 绘制一个帧动画组件。


## Functions

### public func duration(value: Int32): This

```cangjie
public func duration(value: Int32): This
```
功能： 设置播放时长。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| Int32 | 是 | 播放时长。value为0时，不播放图片。value的改变只会在下一次循环开始时生效。 单位：毫秒。 初始值：1000ms。 | value | - |

### public func fillMode(value: FillMode): This

```cangjie
public func fillMode(value: FillMode): This
```
功能： 设置当前播放方向下，动画开始前和结束后的状态。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| FillMode | 是 | 当前播放方向下，动画开始前和结束后的状态。 初始值：FillMode.Forwards。 | value | - |

### public func fixedSize(value: Bool): This

```cangjie
public func fixedSize(value: Bool): This
```
功能： 设置图片大小是否固定为组件大小。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| Bool | 是 | 设置图片大小是否固定为组件大小。 true表示图片大小与组件大小一致，此时设置图片的width、height、top 和left属性是无效的。 false表示每一张图片的width 、height 、top和left属性都要单独设置。 初始值：true。 | value | - |

### public func images(images: Array<ImageFrameInfo>): This

```cangjie
public func images(images: Array<ImageFrameInfo>): This
```
功能： 设置图片帧信息集合。不支持动态更新。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| Array< ImageFrameInfo > | 是 | 设置图片帧信息集合。每一帧的帧信息(ImageFrameInfo)包含图片路径、图片大小、图片位置和图片播放时长信息，详见ImageFrameInfo属性说明。 初始值：[]。 | images | - |

### public func iterations(iterations: Int32): This

```cangjie
public func iterations(iterations: Int32): This
```
功能： 设置播放次数。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| Int32 | 是 | 播放次数，默认播放一次，设置为-1时表示无限次播放。 初始值：1。 | iterations | - |

### @Deprecated public func preDecode(value: Int32): This

```cangjie
@Deprecated public func preDecode(value: Int32): This
```
功能： 设置图片大小是否固定为组件大小。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| Int32 | 是 | 预解码的图片数量。例如该值设为2，则播放当前页时会提前加载后面两张图片至缓存以提升性能。 初始值：0。 | value | - |

### public func reverse(isReverse: Bool): This

```cangjie
public func reverse(isReverse: Bool): This
```
功能： 设置播放方向。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| Bool | 是 | 播放方向。 false表示从第1张图片播放到最后1张图片， true表示从最后1张图片播放到第1张图片。 初始值：false。 | isReverse | - |

### public func state(value: AnimationStatus): This

```cangjie
public func state(value: AnimationStatus): This
```
功能： 控制播放状态。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| AnimationStatus | 是 | 播放状态，默认为初始状态。 初始值：AnimationStatus.Initial。 | value | - |

### public func onCancel(callback: () -> Unit): This

```cangjie
public func onCancel(callback: () -> Unit): This
```
功能： 动画返回最初状态时触发该事件。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| ()->Unit | 是 | 回调函数，动画返回最初状态时触发。 | callback | - |

### public func onFinish(callback: () -> Unit): This

```cangjie
public func onFinish(callback: () -> Unit): This
```
功能： 动画播放完成时或者停止播放时触发该事件。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| ()->Unit | 是 | 回调函数，动画播放完成时或者停止播放时触发。 | callback | - |

### public func onPause(callback: () -> Unit): This

```cangjie
public func onPause(callback: () -> Unit): This
```
功能： 动画暂停播放时触发该事件。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| ()->Unit | 是 | 回调函数，动画暂停播放时触发。 | callback | - |

### public func onRepeat(callback: () -> Unit): This

```cangjie
public func onRepeat(callback: () -> Unit): This
```
功能： 动画重复播放时触发该事件。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| ()->Unit | 是 | 回调函数，动画重复播放时触发。 | callback | - |

### public func onStart(callback: () -> Unit): This

```cangjie
public func onStart(callback: () -> Unit): This
```
功能： 动画开始播放时触发该事件。

**Parameters:**

| type | required | description | name | default |
| --- | --- | --- | --- | --- |
| ()->Unit | 是 | 回调函数，动画开始播放时触发。 | callback | - |


## Classes

### ImageFrameInfo

class ImageFrameInfo
```cangjie
public class ImageFrameInfo { public init( src!: String, duration!: Int32 = 0, width!: Length = 0.vp, height!: Length = 0.vp, top!: Length = 0.vp, left!: Length = 0.vp ) public init( src!: AppResource, duration!: Int32 = 0, width!: Length = 0.vp, height!: Length = 0.vp, top!: Length = 0.vp, left!: Length = 0.vp ) }
```
功能： 图片帧信息，包含图片路径、图片大小、图片位置和图片播放时长信息。



## Examples

```cangjie
package ohos_app_cangjie_entry
import kit.UIKit.*
import ohos.state_macro_manage.*
internal import ohos.resource_manager.*
internal import kit.LocalizationKit.{AppResource, __GenerateResource__}

@Entry
@Component
class EntryView {
 @State var value: Int32 = 1
 @State var state: AnimationStatus = AnimationStatus.Initial
 @State var reverse: Bool = false
 @State var iterations: Int32 = 1
 func build() {
 Column() {
 ImageAnimator()
 .images(
 [
 ImageFrameInfo(src: @r(app.media.media1), duration: 1000, width: 340.vp, height: 240.vp,
 top: 0.vp, left: 0.vp),
 ImageFrameInfo(src: @r(app.media.media2), duration: 1000, width: 340.vp, height: 240.vp,
 top: 0.vp, left: 0.vp),
 ImageFrameInfo(src: @r(app.media.media3), duration: 1000, width: 340.vp, height: 240.vp,
 top: 0.vp, left: 0.vp),
 ImageFrameInfo(src: @r(app.media.media4), duration: 1000, width: 340.vp, height: 240.vp,
 top: 0.vp, left: 0.vp),
 ImageFrameInfo(src: @r(app.media.media5), duration: 1000, width: 340.vp, height: 240.vp,
 top: 0.vp, left: 0.vp)
 ]
 )
 .duration(2000)
 .state(this.state)
 .reverse(this.reverse)
 .fixedSize(false)
 .preDecode(1)
 .fillMode(FillMode.None)
 .iterations(this.iterations)
 .width(340)
 .height(240)
 .margin(top: 100)
 .onStart({
 => AppLog.info("Start")
 })
 .onPause({
 => AppLog.info("Pause")
 })
 .onRepeat({
 => AppLog.info("Repeat")
 })
 .onCancel({
 => AppLog.info("Cancel")
 })
 .onFinish(
 {
 =>
 AppLog.info("Finish")
 this.state = AnimationStatus.Stopped
 }
 )
 Row() {
 Button("start")
 .width(100)
 .padding(5)
 .onClick(
 {
 =>
 this.state = AnimationStatus.Running
 AppLog.info("Start")
 }
 )
 .margin(5)
 .id("start")
 Button("pause")
 .width(100)
 .padding(5)
 .onClick(
 {
 =>
 this.state = AnimationStatus.Paused // 显示当前帧图片
 AppLog.info("Pause")
 }
 )
 .margin(5)
 .id("pause")
 Button("stop")
 .width(100)
 .padding(5)
 .onClick(
 {
 =>
 this.state = AnimationStatus.Stopped // 显示动画的起始帧图片
 AppLog.info("Stop")
 }
 )
 .margin(5)
 .id("stop")
 }
 Row() {
 Button("reverse")
 .width(100)
 .padding(5)
 .onClick({
 => this.reverse = !this.reverse
 })
 .margin(5)
 .id("reverse")
 Button("once")
 .width(100)
 .padding(5)
 .onClick({
 => this.iterations = 1
 })
 .margin(5)
 .id("once")
 Button("infinite")
 .width(100)
 .padding(5)
 .onClick({
 => this.iterations = -1 // 无限循环播放
 })
 .margin(5)
 .id("infinite")
 }
 }
 .width(100.percent)
 .height(100.percent)
 }
}
```

