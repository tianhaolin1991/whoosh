# 自定义组件的生命周期

自定义组件的生命周期回调函数用于通知用户该自定义组件的生命周期，这些回调函数是私有的，在运行时由开发框架在特定的时间进行调用，不能从应用程序中手动调用这些回调函数。不要在多个窗口复用同一个自定义组件节点，其生命周期可能会紊乱。

```cangjie
import kit.UIKit.*
```
## Functions

### protected open func aboutToAppear()

```cangjie
protected open func aboutToAppear()
```
功能： aboutToAppear函数在创建自定义组件的新实例后，在执行其build()函数之前执行。允许在aboutToAppear函数中改变状态变量，更改将在后续执行build()函数中生效。实现自定义布局的自定义组件的aboutToAppear生命周期在布局过程中触发。

### protected open func aboutToDisappear()

```cangjie
protected open func aboutToDisappear()
```
功能： aboutToDisappear函数在自定义组件析构销毁之前执行。不允许在aboutToDisappear函数中改变状态变量，特别是@Link变量的修改可能会导致应用程序行为不稳定。

### protected open func aboutToReuse(params: ReuseParams)

```cangjie
protected open func aboutToReuse(params: ReuseParams)
```
功能： 当一个可复用的自定义组件从复用缓存中重新加入到节点树时，触发aboutToReuse生命周期回调，并将组件的构造参数传递给aboutToReuse。

**Parameters:**

| type | description | name |
| --- | --- | --- |
| ReuseParams | 自定义组件的构造参数。 | params |

### protected open func onBackPress(): Bool

```cangjie
protected open func onBackPress(): Bool
```
功能： 当用户点击返回按钮时触发，仅@Entry装饰的自定义组件生效。返回true表示页面自己处理返回逻辑，不进行页面路由；返回false表示使用默认的路由返回逻辑。

### protected open func onDidBuild()

```cangjie
protected open func onDidBuild()
```
功能： onDidBuild函数在执行自定义组件的build()函数之后执行，开发者可以在这个阶段进行埋点数据上报等不影响实际UI的功能。不建议在onDidBuild函数中更改状态变量、使用animateTo等功能，这可能会导致不稳定的UI表现。

### protected open func onPageHide()

```cangjie
protected open func onPageHide()
```
功能： 页面每次隐藏时触发一次，包括路由过程、应用进入后台等场景，仅@Entry装饰的自定义组件生效。

### protected open func onPageShow()

```cangjie
protected open func onPageShow()
```
功能： 页面每次显示时触发一次，包括路由过程、应用进入前台等场景，仅@Entry装饰的自定义组件生效。


## Classes

### ReuseParams

class ReuseParams
```cangjie
public class ReuseParams { public init() public init(arr: Array<(String, Any)>) }
```
功能： aboutToReuse生命周期函数的参数，开发者可以从中获取可复用组件的构造参数。

#### prop size

```cangjie
public prop size
```
功能： 获取ReusePrams中存放的构造参数键值对数量。



## Examples

```cangjie
package ohos_app_cangjie_entry

import kit.UIKit.*
import ohos.state_macro_manage.*

@Entry
@Component
class EntryView {
 @State var textColor: Color = Color.BLACK;

 protected override func onPageShow() {
 this.textColor = Color.BLUE;
 AppLog.info("onPageShow")
 }

 protected override func onPageHide() {
 this.textColor = Color.WHITE;
 AppLog.info("onPageHide")
 }

 protected override func aboutToDisappear() {
 AppLog.info("aboutToDisappear")
 }

 protected override func aboutToAppear() {
 AppLog.info("aboutToAppear")
 }

 protected override func onBackPress() {
 AppLog.info("onBackPress")
 return false
 }

 protected override func onDidBuild() {
 AppLog.info("onDidBuild")
 }

 func build() {
 Column() {
 Text("Hello World")
 .fontColor(this.textColor)
 .fontSize(30)
 .margin(30)
 }.width(100.percent)
 }
}
```
```cangjie
package ohos_app_cangjie_entry

import kit.UIKit.*
import ohos.state_macro_manage.*

public class Message {
 public var value: String
 public init(val: String) {
 value = val
 }
}

@Entry
@Component
public class EntryView {
 @State var switch: Bool = true
 public func build() {
 Column() {
 Button("Hello")
 .fontSize(30)
 .fontWeight(FontWeight.Bold)
 .onClick{ =>
 switch = !switch
 }
 if (switch) {
 Child(message: Message("Child"))
 }
 }.height(100.percent).width(100.percent)
 }
}

@Reusable
@Component
class Child {
 @State
 var message: Message = Message("about to reuse")

 protected override func aboutToReuse(val: ReuseParams) {
 if (val.contains("message")) {
 let msg = val.get("message").getOrThrow()
 message = msg as Message ?? Message("None")
 AppLog.info("Recycle Child")
 }
 }

 protected override func aboutToRecycle() {
 AppLog.info("aboutToRecycle")
 }

 func build() {
 Column() {
 Text(this.message.value)
 }.borderWidth(1).height(100)
 }
}
```

